<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.TokenAlgebra</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Token algebras}
\label{sec:token-algebra}

</a><a id="53" class="Markup">\begin{code}[hide]</a>
<a id="72" class="Symbol">{-#</a> <a id="76" class="Keyword">OPTIONS</a> <a id="84" class="Pragma">--safe</a> <a id="91" class="Symbol">#-}</a>

<a id="96" class="Keyword">module</a> <a id="103" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="123" class="Symbol">(</a><a id="124" href="Ledger.TokenAlgebra.html#124" class="Bound">PolicyId</a> <a id="133" class="Symbol">:</a> <a id="135" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="138" class="Symbol">)</a> <a id="140" class="Keyword">where</a>

<a id="147" class="Keyword">open</a> <a id="152" class="Keyword">import</a> <a id="159" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="175" class="Keyword">open</a> <a id="180" class="Keyword">import</a> <a id="187" href="Algebra.html" class="Module">Algebra</a>              <a id="208" class="Keyword">using</a> <a id="214" class="Symbol">(</a><a id="215" href="Algebra.Bundles.html#6578" class="Record">CommutativeMonoid</a> <a id="233" class="Symbol">;</a> <a id="235" href="Algebra.Bundles.html#6007" class="Record">Monoid</a><a id="241" class="Symbol">)</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Algebra.Morphism.html" class="Module">Algebra.Morphism</a>     <a id="276" class="Keyword">using</a> <a id="282" class="Symbol">(</a><a id="283" class="Keyword">module</a> <a id="290" href="Algebra.Morphism.Structures.html#2379" class="Module">MonoidMorphisms</a> <a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>  <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Data.Nat.Properties.html#16387" class="Function">+-0-monoid</a><a id="358" class="Symbol">)</a>
<a id="360" class="Keyword">open</a> <a id="365" class="Keyword">import</a> <a id="372" href="Relation.Binary.html" class="Module">Relation.Binary</a>      <a id="393" class="Keyword">using</a> <a id="399" class="Symbol">(</a><a id="400" href="Relation.Binary.Core.html#882" class="Function">Rel</a><a id="403" class="Symbol">)</a>
<a id="405" class="Keyword">open</a> <a id="410" class="Keyword">import</a> <a id="417" href="Relation.Unary.html" class="Module">Relation.Unary</a>       <a id="438" class="Keyword">using</a> <a id="444" class="Symbol">(</a><a id="445" href="Relation.Unary.html#1111" class="Function">Pred</a><a id="449" class="Symbol">)</a>
<a id="451" class="Markup">\end{code}</a><a id="461" class="Background">

\begin{figure*}
</a><a id="479" class="Markup">\begin{code}</a>
<a id="492" class="Keyword">record</a> <a id="TokenAlgebra"></a><a id="499" href="Ledger.TokenAlgebra.html#499" class="Record">TokenAlgebra</a> <a id="512" class="Symbol">:</a> <a id="514" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="519" class="Keyword">where</a>
  <a id="527" class="Keyword">field</a>  <a id="TokenAlgebra.Value-CommutativeMonoid"></a><a id="534" href="Ledger.TokenAlgebra.html#534" class="Field">Value-CommutativeMonoid</a> <a id="558" class="Symbol">:</a> <a id="560" href="Algebra.Bundles.html#6578" class="Record">CommutativeMonoid</a> <a id="578" href="Level.html#512" class="Function">0ℓ</a> <a id="581" href="Level.html#512" class="Function">0ℓ</a>

  <a id="TokenAlgebra.MemoryEstimate"></a><a id="587" href="Ledger.TokenAlgebra.html#587" class="Function">MemoryEstimate</a> <a id="602" class="Symbol">:</a> <a id="604" href="Agda.Primitive.html#320" class="Primitive">Set</a>
  <a id="610" href="Ledger.TokenAlgebra.html#587" class="Function">MemoryEstimate</a> <a id="625" class="Symbol">=</a> <a id="627" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="629" class="Markup">\end{code}</a><a id="639" class="Background">
</a><a id="640" class="Markup">\begin{code}[hide]</a>
  <a id="661" class="Keyword">open</a> <a id="666" href="Algebra.Bundles.html#6578" class="Module">CommutativeMonoid</a> <a id="684" href="Ledger.TokenAlgebra.html#534" class="Field">Value-CommutativeMonoid</a> <a id="708" class="Keyword">public</a>
    <a id="719" class="Keyword">using</a> <a id="725" class="Symbol">(</a><a id="726" href="Algebra.Bundles.html#6700" class="Field Operator">_≈_</a> <a id="730" class="Symbol">;</a> <a id="732" href="Algebra.Bundles.html#6778" class="Field">ε</a> <a id="734" class="Symbol">;</a> <a id="736" href="Algebra.Bundles.html#6922" class="Function">monoid</a> <a id="743" class="Symbol">;</a> <a id="745" href="Algebra.Bundles.html#6400" class="Function">rawMonoid</a><a id="754" class="Symbol">)</a>
    <a id="760" class="Keyword">renaming</a> <a id="769" class="Symbol">(</a><a id="770" href="Algebra.Bundles.html#6668" class="Field">Carrier</a> <a id="778" class="Symbol">to</a> <a id="781" class="Field">Value</a> <a id="787" class="Symbol">;</a> <a id="789" href="Relation.Binary.Structures.html#1582" class="Function">refl</a> <a id="794" class="Symbol">to</a> <a id="797" class="Function">reflᵛ</a> <a id="803" class="Symbol">;</a> <a id="805" href="Algebra.Bundles.html#6740" class="Field Operator">_∙_</a> <a id="809" class="Symbol">to</a> <a id="812" class="Field Operator">_+ᵛ_</a><a id="816" class="Symbol">)</a>

  <a id="821" class="Keyword">open</a> <a id="826" href="Algebra.Morphism.Structures.html#2379" class="Module">MonoidMorphisms</a> <a id="842" class="Symbol">(</a><a id="843" href="Algebra.Bundles.html#6400" class="Function">rawMonoid</a><a id="852" class="Symbol">)</a> <a id="854" class="Symbol">(</a><a id="855" href="Algebra.Bundles.html#6400" class="Function">Monoid.rawMonoid</a> <a id="872" href="Data.Nat.Properties.html#16387" class="Function">+-0-monoid</a><a id="882" class="Symbol">)</a> <a id="884" class="Keyword">public</a>
<a id="891" class="Markup">\end{code}</a><a id="901" class="Background">
</a><a id="902" class="Markup">\begin{code}</a>
  <a id="917" class="Keyword">field</a>  <a id="TokenAlgebra.coin"></a><a id="924" href="Ledger.TokenAlgebra.html#924" class="Field">coin</a>                      <a id="950" class="Symbol">:</a> <a id="952" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a> <a id="958" class="Symbol">→</a> <a id="960" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
         <a id="TokenAlgebra.inject"></a><a id="974" href="Ledger.TokenAlgebra.html#974" class="Field">inject</a>                    <a id="1000" class="Symbol">:</a> <a id="1002" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1007" class="Symbol">→</a> <a id="1009" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
         <a id="TokenAlgebra.policies"></a><a id="1024" href="Ledger.TokenAlgebra.html#1024" class="Field">policies</a>                  <a id="1050" class="Symbol">:</a> <a id="1052" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a> <a id="1058" class="Symbol">→</a> <a id="1060" href="Ledger.Prelude.html#1514" class="Function Operator">ℙ</a> <a id="1062" href="Ledger.TokenAlgebra.html#124" class="Bound">PolicyId</a>
         <a id="TokenAlgebra.size"></a><a id="1080" href="Ledger.TokenAlgebra.html#1080" class="Field">size</a>                      <a id="1106" class="Symbol">:</a> <a id="1108" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a> <a id="1114" class="Symbol">→</a> <a id="1116" href="Ledger.TokenAlgebra.html#587" class="Function">MemoryEstimate</a>
         <a id="TokenAlgebra._≤ᵗ_"></a><a id="1140" href="Ledger.TokenAlgebra.html#1140" class="Field Operator">_≤ᵗ_</a>                      <a id="1166" class="Symbol">:</a> <a id="1168" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a> <a id="1174" class="Symbol">→</a> <a id="1176" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a> <a id="1182" class="Symbol">→</a> <a id="1184" href="Agda.Primitive.html#320" class="Primitive">Set</a>
         <a id="TokenAlgebra.AssetName"></a><a id="1197" href="Ledger.TokenAlgebra.html#1197" class="Field">AssetName</a>                 <a id="1223" class="Symbol">:</a> <a id="1225" href="Agda.Primitive.html#320" class="Primitive">Set</a>
         <a id="TokenAlgebra.specialAsset"></a><a id="1238" href="Ledger.TokenAlgebra.html#1238" class="Field">specialAsset</a>              <a id="1264" class="Symbol">:</a> <a id="1266" href="Ledger.TokenAlgebra.html#1197" class="Field">AssetName</a>
         <a id="TokenAlgebra.property"></a><a id="1285" href="Ledger.TokenAlgebra.html#1285" class="Field">property</a>                  <a id="1311" class="Symbol">:</a> <a id="1313" href="Ledger.TokenAlgebra.html#924" class="Field">coin</a> <a id="1318" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="1320" href="Ledger.TokenAlgebra.html#974" class="Field">inject</a> <a id="1327" href="Relation.Binary.PropositionalEquality.html#1475" class="Function Operator">≗</a> <a id="1329" href="Function.Base.html#695" class="Function">id</a>
         <a id="TokenAlgebra.coinIsMonoidHomomorphism"></a><a id="1341" href="Ledger.TokenAlgebra.html#1341" class="Field">coinIsMonoidHomomorphism</a>  <a id="1367" class="Symbol">:</a> <a id="1369" href="Algebra.Morphism.Structures.html#2756" class="Record">IsMonoidHomomorphism</a> <a id="1390" href="Ledger.TokenAlgebra.html#924" class="Field">coin</a>
<a id="1395" class="Markup">\end{code}</a><a id="1405" class="Background">
</a><a id="1406" class="Markup">\begin{code}[hide]</a>
         <a id="1434" class="Symbol">⦃</a> <a id="TokenAlgebra.DecEq-Value"></a><a id="1436" href="Ledger.TokenAlgebra.html#1436" class="Field">DecEq-Value</a> <a id="1448" class="Symbol">⦄</a> <a id="1450" class="Symbol">:</a> <a id="1452" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1458" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>

  <a id="1467" class="Keyword">instance</a>
    <a id="TokenAlgebra.addValue"></a><a id="1480" href="Ledger.TokenAlgebra.html#1480" class="Function">addValue</a> <a id="1489" class="Symbol">:</a> <a id="1491" href="Interface.HasAdd.html#83" class="Record">HasAdd</a> <a id="1498" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
    <a id="1508" href="Ledger.TokenAlgebra.html#1480" class="Function">addValue</a> <a id="1517" class="Symbol">=</a> <a id="1519" class="Keyword">record</a> <a id="1526" class="Symbol">{</a> <a id="1528" href="Interface.HasAdd.html#135" class="Field Operator">_+_</a> <a id="1532" class="Symbol">=</a> <a id="1534" href="Ledger.TokenAlgebra.html#812" class="Function Operator">_+ᵛ_</a> <a id="1539" class="Symbol">}</a>


<a id="1543" class="Markup">\end{code}</a><a id="1553" class="Background">
</a><a id="1554" class="Markup">\begin{code}</a>
  <a id="TokenAlgebra.sumᵛ"></a><a id="1569" href="Ledger.TokenAlgebra.html#1569" class="Function">sumᵛ</a> <a id="1574" class="Symbol">:</a> <a id="1576" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1581" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a> <a id="1587" class="Symbol">→</a> <a id="1589" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="1597" href="Ledger.TokenAlgebra.html#1569" class="Function">sumᵛ</a> <a id="1602" class="Symbol">=</a> <a id="1604" href="Data.List.Base.html#4311" class="Function">foldr</a> <a id="1610" href="Ledger.TokenAlgebra.html#812" class="Function Operator">_+ᵛ_</a> <a id="1615" class="Symbol">(</a><a id="1616" href="Ledger.TokenAlgebra.html#974" class="Field">inject</a> <a id="1623" class="Number">0</a><a id="1624" class="Symbol">)</a>
<a id="1626" class="Markup">\end{code}</a><a id="1636" class="Background">
\caption{Token algebras, used for multi-assets}
\end{figure*}
</a></pre></body></html>