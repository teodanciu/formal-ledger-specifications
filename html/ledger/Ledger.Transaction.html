<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Transaction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Transactions}
\label{sec:transactions}

</a><a id="50" class="Markup">\begin{code}[hide]</a>
<a id="69" class="Symbol">{-#</a> <a id="73" class="Keyword">OPTIONS</a> <a id="81" class="Pragma">--safe</a> <a id="88" class="Symbol">#-}</a>
<a id="92" class="Comment">--------------------------------------------------------------------------------</a>
<a id="173" class="Comment">-- NOTE: Everything in this module is part of TransactionStructure</a>
<a id="240" class="Comment">--------------------------------------------------------------------------------</a>
<a id="321" class="Keyword">module</a> <a id="328" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a> <a id="347" class="Keyword">where</a>

<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Ledger.Epoch.html" class="Module">Ledger.Epoch</a>
<a id="433" class="Keyword">open</a> <a id="438" class="Keyword">import</a> <a id="445" href="Ledger.GovStructure.html" class="Module">Ledger.GovStructure</a>
<a id="465" class="Keyword">import</a> <a id="472" href="Ledger.PParams.html" class="Module">Ledger.PParams</a>
<a id="487" class="Keyword">import</a> <a id="494" href="Ledger.Script.html" class="Module">Ledger.Script</a>
<a id="508" class="Keyword">import</a> <a id="515" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a>
<a id="540" class="Keyword">import</a> <a id="547" href="Ledger.Deleg.html" class="Module">Ledger.Deleg</a>
<a id="560" class="Keyword">import</a> <a id="567" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a>
<a id="587" class="Keyword">import</a> <a id="594" href="Ledger.Address.html" class="Module">Ledger.Address</a>

<a id="610" class="Keyword">record</a> <a id="TransactionStructure"></a><a id="617" href="Ledger.Transaction.html#617" class="Record">TransactionStructure</a> <a id="638" class="Symbol">:</a> <a id="640" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="645" class="Keyword">where</a>
  <a id="653" class="Keyword">field</a>
<a id="659" class="Markup">\end{code}</a><a id="669" class="Background">

Transactions are defined in Figure~\ref{fig:defs:utxo-shelley}. A
transaction is made up of a transaction body, a collection of
witnesses and some optional auxiliary data. Some key ingredients in
the transaction body are:

\begin{itemize}
  \item A set of transaction inputs, each of which identifies an output from a previous transaction.
    A transaction input consists of a transaction id and an index to uniquely identify the output.
  \item An indexed collection of transaction outputs.
    The \TxOut type is an address paired with a coin value.
  \item A transaction fee. This value will be added to the fee pot.
  \item The size and the hash of the serialized form of the transaction that was included in the block.
\end{itemize}

\begin{figure*}[h]
\emph{Abstract types}
\AgdaTarget{Ix, TxId, Epoch, AuxiliaryData}
</a><a id="1496" class="Markup">\begin{code}</a>
        <a id="TransactionStructure.Ix"></a><a id="1517" href="Ledger.Transaction.html#1517" class="Field">Ix</a> <a id="TransactionStructure.TxId"></a><a id="1520" href="Ledger.Transaction.html#1520" class="Field">TxId</a> <a id="TransactionStructure.AuxiliaryData"></a><a id="1525" href="Ledger.Transaction.html#1525" class="Field">AuxiliaryData</a> <a id="1539" class="Symbol">:</a> <a id="1541" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="1545" class="Markup">\end{code}</a><a id="1555" class="Background">
</a><a id="1556" class="Markup">\begin{code}[hide]</a>
        <a id="1583" class="Symbol">⦃</a> <a id="TransactionStructure.DecEq-Ix"></a><a id="1585" href="Ledger.Transaction.html#1585" class="Field">DecEq-Ix</a>   <a id="1596" class="Symbol">⦄</a> <a id="1598" class="Symbol">:</a> <a id="1600" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1606" href="Ledger.Transaction.html#1517" class="Field">Ix</a>
        <a id="1617" class="Symbol">⦃</a> <a id="TransactionStructure.DecEq-TxId"></a><a id="1619" href="Ledger.Transaction.html#1619" class="Field">DecEq-TxId</a> <a id="1630" class="Symbol">⦄</a> <a id="1632" class="Symbol">:</a> <a id="1634" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1640" href="Ledger.Transaction.html#1520" class="Field">TxId</a>
        <a id="TransactionStructure.adHashingScheme"></a><a id="1653" href="Ledger.Transaction.html#1653" class="Field">adHashingScheme</a> <a id="1669" class="Symbol">:</a> <a id="1671" href="Ledger.Crypto.html#190" class="Record">isHashableSet</a> <a id="1685" href="Ledger.Transaction.html#1525" class="Field">AuxiliaryData</a>
  <a id="1701" class="Keyword">open</a> <a id="1706" href="Ledger.Crypto.html#190" class="Module">isHashableSet</a> <a id="1720" href="Ledger.Transaction.html#1653" class="Field">adHashingScheme</a> <a id="1736" class="Keyword">renaming</a> <a id="1745" class="Symbol">(</a><a id="1746" href="Ledger.Crypto.html#265" class="Field">THash</a> <a id="1752" class="Symbol">to</a> <a id="1755" class="Field">ADHash</a><a id="1761" class="Symbol">)</a> <a id="1763" class="Keyword">public</a>

  <a id="1773" class="Keyword">field</a> <a id="TransactionStructure.globalConstants"></a><a id="1779" href="Ledger.Transaction.html#1779" class="Field">globalConstants</a> <a id="1795" class="Symbol">:</a> <a id="1797" class="Symbol">_</a>
  <a id="1801" class="Keyword">open</a> <a id="1806" href="Ledger.Epoch.html#3611" class="Module">GlobalConstants</a> <a id="1822" href="Ledger.Transaction.html#1779" class="Field">globalConstants</a> <a id="1838" class="Keyword">public</a>

  <a id="1848" class="Keyword">field</a> <a id="TransactionStructure.epochStructure"></a><a id="1854" href="Ledger.Transaction.html#1854" class="Field">epochStructure</a> <a id="1869" class="Symbol">:</a> <a id="1871" class="Symbol">_</a>
  <a id="1875" class="Keyword">open</a> <a id="1880" href="Ledger.Epoch.html#415" class="Module">EpochStructure</a> <a id="1895" href="Ledger.Transaction.html#1854" class="Field">epochStructure</a> <a id="1910" class="Keyword">public</a>
  <a id="1919" class="Keyword">open</a> <a id="1924" href="Ledger.PParams.html" class="Module">Ledger.PParams</a> <a id="1939" href="Ledger.Transaction.html#1854" class="Field">epochStructure</a> <a id="1954" class="Keyword">public</a>

  <a id="1964" class="Keyword">field</a> <a id="TransactionStructure.govParams"></a><a id="1970" href="Ledger.Transaction.html#1970" class="Field">govParams</a> <a id="1980" class="Symbol">:</a> <a id="1982" class="Symbol">_</a>
  <a id="1986" class="Keyword">open</a> <a id="1991" href="Ledger.PParams.html#5151" class="Module">GovParams</a> <a id="2001" href="Ledger.Transaction.html#1970" class="Field">govParams</a> <a id="2011" class="Keyword">public</a>

  <a id="2021" class="Keyword">field</a> <a id="TransactionStructure.crypto"></a><a id="2027" href="Ledger.Transaction.html#2027" class="Field">crypto</a> <a id="2034" class="Symbol">:</a> <a id="2036" class="Symbol">_</a>
  <a id="2040" class="Keyword">open</a> <a id="2045" href="Ledger.Crypto.html#1510" class="Module">Crypto</a> <a id="2052" href="Ledger.Transaction.html#2027" class="Field">crypto</a> <a id="2059" class="Keyword">public</a> <a id="2066" class="Comment">-- renaming (DecEq-THash to DecEq-ScriptHash)</a>

  <a id="2115" class="Keyword">field</a> <a id="TransactionStructure.txidBytes"></a><a id="2121" href="Ledger.Transaction.html#2121" class="Field">txidBytes</a> <a id="2131" class="Symbol">:</a> <a id="2133" href="Ledger.Transaction.html#1520" class="Field">TxId</a> <a id="2138" class="Symbol">→</a> <a id="2140" href="Ledger.Crypto.html#735" class="Function">Ser</a>
        <a id="TransactionStructure.networkId"></a><a id="2152" href="Ledger.Transaction.html#2152" class="Field">networkId</a> <a id="2162" class="Symbol">:</a> <a id="2164" href="Ledger.Epoch.html#3648" class="Function">Network</a>

  <a id="2175" class="Keyword">open</a> <a id="2180" href="Ledger.Address.html" class="Module">Ledger.Address</a> <a id="2195" href="Ledger.Epoch.html#3648" class="Function">Network</a> <a id="2203" href="Ledger.Crypto.html#1735" class="Function">KeyHash</a> <a id="2211" href="Ledger.Crypto.html#1632" class="Function">ScriptHash</a> <a id="2222" class="Keyword">public</a>
  <a id="2231" class="Keyword">open</a> <a id="2236" href="Ledger.Script.html" class="Module">Ledger.Script</a>  <a id="2251" href="Ledger.Crypto.html#1735" class="Function">KeyHash</a> <a id="2259" href="Ledger.Crypto.html#1632" class="Function">ScriptHash</a> <a id="2270" href="Ledger.Epoch.html#548" class="Function">Slot</a> <a id="2275" class="Keyword">public</a>
  <a id="2284" class="Keyword">open</a> <a id="2289" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="2309" href="Ledger.Crypto.html#1632" class="Function">ScriptHash</a> <a id="2320" class="Keyword">public</a>

  <a id="2330" class="Keyword">field</a> <a id="TransactionStructure.ss"></a><a id="2336" href="Ledger.Transaction.html#2336" class="Field">ss</a>           <a id="2349" class="Symbol">:</a> <a id="2351" href="Ledger.Script.html#1307" class="Record">ScriptStructure</a>
        <a id="TransactionStructure.tokenAlgebra"></a><a id="2375" href="Ledger.Transaction.html#2375" class="Field">tokenAlgebra</a> <a id="2388" class="Symbol">:</a> <a id="2390" href="Ledger.TokenAlgebra.html#499" class="Record">TokenAlgebra</a>
  <a id="2405" class="Keyword">open</a> <a id="2410" href="Ledger.Script.html#1307" class="Module">ScriptStructure</a> <a id="2426" href="Ledger.Transaction.html#2336" class="Field">ss</a>        <a id="2436" class="Keyword">public</a>
  <a id="2445" class="Keyword">open</a> <a id="2450" href="Ledger.TokenAlgebra.html#499" class="Module">TokenAlgebra</a> <a id="2463" href="Ledger.Transaction.html#2375" class="Field">tokenAlgebra</a> <a id="2476" class="Keyword">public</a>

  <a id="TransactionStructure.govStructure"></a><a id="2486" href="Ledger.Transaction.html#2486" class="Function">govStructure</a> <a id="2499" class="Symbol">:</a> <a id="2501" href="Ledger.GovStructure.html#168" class="Record">GovStructure</a>
  <a id="2516" href="Ledger.Transaction.html#2486" class="Function">govStructure</a> <a id="2529" class="Symbol">=</a> <a id="2531" class="Keyword">record</a>
    <a id="2542" class="Comment">-- TODO: figure out what to do with the hash</a>
    <a id="2591" class="Symbol">{</a> <a id="2593" href="Ledger.GovStructure.html#202" class="Field">TxId</a> <a id="2598" class="Symbol">=</a> <a id="2600" href="Ledger.Transaction.html#1520" class="Field">TxId</a><a id="2604" class="Symbol">;</a> <a id="2606" href="Ledger.GovStructure.html#207" class="Field">Network</a> <a id="2614" class="Symbol">=</a> <a id="2616" href="Ledger.Epoch.html#3648" class="Function">Network</a><a id="2623" class="Symbol">;</a> <a id="2625" href="Ledger.GovStructure.html#215" class="Field">DocHash</a> <a id="2633" class="Symbol">=</a> <a id="2635" href="Ledger.Transaction.html#1755" class="Function">ADHash</a>
    <a id="2646" class="Symbol">;</a> <a id="2648" href="Ledger.GovStructure.html#313" class="Field">epochStructure</a> <a id="2663" class="Symbol">=</a> <a id="2665" href="Ledger.Transaction.html#1854" class="Field">epochStructure</a><a id="2679" class="Symbol">;</a> <a id="2681" href="Ledger.GovStructure.html#429" class="Field">govParams</a> <a id="2691" class="Symbol">=</a> <a id="2693" href="Ledger.Transaction.html#1970" class="Field">govParams</a><a id="2702" class="Symbol">;</a> <a id="2704" href="Ledger.GovStructure.html#486" class="Field">crypto</a> <a id="2711" class="Symbol">=</a> <a id="2713" href="Ledger.Transaction.html#2027" class="Field">crypto</a>
    <a id="2724" class="Symbol">}</a>
  <a id="2728" class="Keyword">open</a> <a id="2733" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a> <a id="2758" href="Ledger.Transaction.html#2486" class="Function">govStructure</a> <a id="2771" class="Keyword">hiding</a> <a id="2778" class="Symbol">(</a><a id="2779" href="Ledger.GovernanceActions.html#8324" class="InductiveConstructor">yes</a><a id="2782" class="Symbol">;</a> <a id="2784" href="Ledger.GovernanceActions.html#8328" class="InductiveConstructor">no</a><a id="2786" class="Symbol">)</a> <a id="2788" class="Keyword">public</a>
  <a id="2797" class="Keyword">open</a> <a id="2802" href="Ledger.Deleg.html" class="Module">Ledger.Deleg</a>             <a id="2827" href="Ledger.Transaction.html#2486" class="Function">govStructure</a> <a id="2840" class="Keyword">public</a>
<a id="2847" class="Markup">\end{code}</a><a id="2857" class="Background">
\emph{Derived types}
\AgdaTarget{TxIn, TxOut, UTxO, Wdrl}
</a><a id="2916" class="Markup">\begin{code}</a>
  <a id="TransactionStructure.TxIn"></a><a id="2931" href="Ledger.Transaction.html#2931" class="Function">TxIn</a>   <a id="2938" class="Symbol">=</a> <a id="2940" href="Ledger.Transaction.html#1520" class="Field">TxId</a> <a id="2945" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="2947" href="Ledger.Transaction.html#1517" class="Field">Ix</a>
  <a id="TransactionStructure.TxOut"></a><a id="2952" href="Ledger.Transaction.html#2952" class="Function">TxOut</a>  <a id="2959" class="Symbol">=</a> <a id="2961" href="Ledger.Address.html#1701" class="Function">Addr</a> <a id="2966" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="2968" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="TransactionStructure.UTxO"></a><a id="2976" href="Ledger.Transaction.html#2976" class="Function">UTxO</a>   <a id="2983" class="Symbol">=</a> <a id="2985" href="Ledger.Transaction.html#2931" class="Function">TxIn</a> <a id="2990" href="Ledger.Prelude.html#2629" class="Function Operator">⇀</a> <a id="2992" href="Ledger.Transaction.html#2952" class="Function">TxOut</a>
  <a id="TransactionStructure.Wdrl"></a><a id="3000" href="Ledger.Transaction.html#3000" class="Function">Wdrl</a>   <a id="3007" class="Symbol">=</a> <a id="3009" href="Ledger.Address.html#1216" class="Record">RwdAddr</a> <a id="3017" href="Ledger.Prelude.html#2629" class="Function Operator">⇀</a> <a id="3019" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

  <a id="TransactionStructure.ProposedPPUpdates"></a><a id="3027" href="Ledger.Transaction.html#3027" class="Function">ProposedPPUpdates</a>  <a id="3046" class="Symbol">=</a> <a id="3048" href="Ledger.Crypto.html#1735" class="Function">KeyHash</a> <a id="3056" href="Ledger.Prelude.html#2629" class="Function Operator">⇀</a> <a id="3058" href="Ledger.PParams.html#5248" class="Function">PParamsUpdate</a>
  <a id="TransactionStructure.Update"></a><a id="3074" href="Ledger.Transaction.html#3074" class="Function">Update</a>             <a id="3093" class="Symbol">=</a> <a id="3095" href="Ledger.Transaction.html#3027" class="Function">ProposedPPUpdates</a> <a id="3113" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3115" href="Ledger.Epoch.html#502" class="Function">Epoch</a>
<a id="3121" class="Markup">\end{code}</a><a id="3131" class="Background">
\emph{Transaction types}
\AgdaTarget{TxBody, txins, txouts, txfee, txvldt, txwdrls, txup, txADhash, txsize, txid, TxWitnesses, vkSigs, scripts, Tx, body, wits, txAD}
\begin{AgdaSuppressSpace}
</a><a id="3324" class="Markup">\begin{code}</a>
  <a id="3339" class="Keyword">record</a> <a id="TransactionStructure.TxBody"></a><a id="3346" href="Ledger.Transaction.html#3346" class="Record">TxBody</a> <a id="3353" class="Symbol">:</a> <a id="3355" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="3359" class="Keyword">where</a>
    <a id="3369" class="Keyword">field</a> <a id="3375" href="Ledger.Transaction.html#3375" class="Field">txins</a>       <a id="3387" class="Symbol">:</a> <a id="3389" href="Ledger.Prelude.html#1514" class="Function Operator">ℙ</a> <a id="3391" href="Ledger.Transaction.html#2931" class="Function">TxIn</a>
          <a id="3406" href="Ledger.Transaction.html#3406" class="Field">txouts</a>      <a id="3418" class="Symbol">:</a> <a id="3420" href="Ledger.Transaction.html#1517" class="Field">Ix</a> <a id="3423" href="Ledger.Prelude.html#2629" class="Function Operator">⇀</a> <a id="3425" href="Ledger.Transaction.html#2952" class="Function">TxOut</a>
          <a id="3441" href="Ledger.Transaction.html#3441" class="Field">txfee</a>       <a id="3453" class="Symbol">:</a> <a id="3455" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
          <a id="3470" href="Ledger.Transaction.html#3470" class="Field">mint</a>        <a id="3482" class="Symbol">:</a> <a id="3484" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
          <a id="3500" href="Ledger.Transaction.html#3500" class="Field">txvldt</a>      <a id="3512" class="Symbol">:</a> <a id="3514" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3520" href="Ledger.Epoch.html#548" class="Function">Slot</a> <a id="3525" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3527" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3533" href="Ledger.Epoch.html#548" class="Function">Slot</a>
          <a id="3548" href="Ledger.Transaction.html#3548" class="Field">txcerts</a>     <a id="3560" class="Symbol">:</a> <a id="3562" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3567" href="Ledger.Deleg.html#354" class="Datatype">DCert</a>
          <a id="3583" href="Ledger.Transaction.html#3583" class="Field">txwdrls</a>     <a id="3595" class="Symbol">:</a> <a id="3597" href="Ledger.Transaction.html#3000" class="Function">Wdrl</a>
          <a id="3612" href="Ledger.Transaction.html#3612" class="Field">txvote</a>      <a id="3624" class="Symbol">:</a> <a id="3626" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3631" href="Ledger.GovernanceActions.html#8355" class="Record">GovVote</a>
          <a id="3649" href="Ledger.Transaction.html#3649" class="Field">txprop</a>      <a id="3661" class="Symbol">:</a> <a id="3663" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3668" href="Ledger.GovernanceActions.html#8542" class="Record">GovProposal</a>
          <a id="3690" href="Ledger.Transaction.html#3690" class="Field">txdonation</a>  <a id="3702" class="Symbol">:</a> <a id="3704" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
          <a id="3719" href="Ledger.Transaction.html#3719" class="Field">txup</a>        <a id="3731" class="Symbol">:</a> <a id="3733" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3739" href="Ledger.Transaction.html#3074" class="Function">Update</a>
          <a id="3756" href="Ledger.Transaction.html#3756" class="Field">txADhash</a>    <a id="3768" class="Symbol">:</a> <a id="3770" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3776" href="Ledger.Transaction.html#1755" class="Function">ADHash</a>
          <a id="3793" href="Ledger.Transaction.html#3793" class="Field">netwrk</a>      <a id="3805" class="Symbol">:</a> <a id="3807" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3813" href="Ledger.Epoch.html#3648" class="Function">Network</a>
          <a id="3831" href="Ledger.Transaction.html#3831" class="Field">txsize</a>      <a id="3843" class="Symbol">:</a> <a id="3845" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
          <a id="3857" href="Ledger.Transaction.html#3857" class="Field">txid</a>        <a id="3869" class="Symbol">:</a> <a id="3871" href="Ledger.Transaction.html#1520" class="Field">TxId</a>

  <a id="3879" class="Keyword">record</a> <a id="TransactionStructure.TxWitnesses"></a><a id="3886" href="Ledger.Transaction.html#3886" class="Record">TxWitnesses</a> <a id="3898" class="Symbol">:</a> <a id="3900" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="3904" class="Keyword">where</a>
    <a id="3914" class="Keyword">field</a> <a id="3920" href="Ledger.Transaction.html#3920" class="Field">vkSigs</a>   <a id="3929" class="Symbol">:</a> <a id="3931" href="Ledger.Crypto.html#726" class="Function">VKey</a> <a id="3936" href="Ledger.Prelude.html#2629" class="Function Operator">⇀</a> <a id="3938" href="Ledger.Crypto.html#731" class="Function">Sig</a>
          <a id="3952" href="Ledger.Transaction.html#3952" class="Field">scripts</a>  <a id="3961" class="Symbol">:</a> <a id="3963" href="Ledger.Prelude.html#1514" class="Function Operator">ℙ</a> <a id="3965" href="Ledger.Script.html#1635" class="Function">Script</a>

    <a id="TransactionStructure.TxWitnesses.scriptsP1"></a><a id="3977" href="Ledger.Transaction.html#3977" class="Function">scriptsP1</a> <a id="3987" class="Symbol">:</a> <a id="3989" href="Ledger.Prelude.html#1514" class="Function Operator">ℙ</a> <a id="3991" href="Ledger.Script.html#444" class="Function">P1Script</a>
    <a id="4004" href="Ledger.Transaction.html#3977" class="Function">scriptsP1</a> <a id="4014" class="Symbol">=</a> <a id="4016" href="Axiom.Set.html#7573" class="Function">mapPartial</a> <a id="4027" href="Data.Sum.html#964" class="Function">isInj₁</a> <a id="4034" href="Ledger.Transaction.html#3952" class="Field">scripts</a>

  <a id="4045" class="Keyword">record</a> <a id="TransactionStructure.Tx"></a><a id="4052" href="Ledger.Transaction.html#4052" class="Record">Tx</a> <a id="4055" class="Symbol">:</a> <a id="4057" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="4061" class="Keyword">where</a>
    <a id="4071" class="Keyword">field</a> <a id="4077" href="Ledger.Transaction.html#4077" class="Field">body</a>  <a id="4083" class="Symbol">:</a> <a id="4085" href="Ledger.Transaction.html#3346" class="Record">TxBody</a>
          <a id="4102" href="Ledger.Transaction.html#4102" class="Field">wits</a>  <a id="4108" class="Symbol">:</a> <a id="4110" href="Ledger.Transaction.html#3886" class="Record">TxWitnesses</a>
          <a id="4132" href="Ledger.Transaction.html#4132" class="Field">txAD</a>  <a id="4138" class="Symbol">:</a> <a id="4140" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4146" href="Ledger.Transaction.html#1525" class="Field">AuxiliaryData</a>
<a id="4160" class="Markup">\end{code}</a><a id="4170" class="Background">
\end{AgdaSuppressSpace}
\caption{Definitions used in the UTxO transition system}
\label{fig:defs:utxo-shelley}
\end{figure*}

\begin{figure*}[h]
</a><a id="4316" class="Markup">\begin{code}</a>
  <a id="TransactionStructure.getValue"></a><a id="4331" href="Ledger.Transaction.html#4331" class="Function">getValue</a> <a id="4340" class="Symbol">:</a> <a id="4342" href="Ledger.Transaction.html#2952" class="Function">TxOut</a> <a id="4348" class="Symbol">→</a> <a id="4350" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="4358" href="Ledger.Transaction.html#4331" class="Function">getValue</a> <a id="4367" class="Symbol">(_</a> <a id="4370" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4372" href="Ledger.Transaction.html#4372" class="Bound">v</a><a id="4373" class="Symbol">)</a> <a id="4375" class="Symbol">=</a> <a id="4377" href="Ledger.Transaction.html#4372" class="Bound">v</a>

  <a id="TransactionStructure.txinsVKey"></a><a id="4382" href="Ledger.Transaction.html#4382" class="Function">txinsVKey</a> <a id="4392" class="Symbol">:</a> <a id="4394" href="Ledger.Prelude.html#1514" class="Function Operator">ℙ</a> <a id="4396" href="Ledger.Transaction.html#2931" class="Function">TxIn</a> <a id="4401" class="Symbol">→</a> <a id="4403" href="Ledger.Transaction.html#2976" class="Function">UTxO</a> <a id="4408" class="Symbol">→</a> <a id="4410" href="Ledger.Prelude.html#1514" class="Function Operator">ℙ</a> <a id="4412" href="Ledger.Transaction.html#2931" class="Function">TxIn</a>
  <a id="4419" href="Ledger.Transaction.html#4382" class="Function">txinsVKey</a> <a id="4429" href="Ledger.Transaction.html#4429" class="Bound">txins</a> <a id="4435" href="Ledger.Transaction.html#4435" class="Bound">utxo</a> <a id="4440" class="Symbol">=</a> <a id="4442" href="Ledger.Transaction.html#4429" class="Bound">txins</a> <a id="4448" href="Axiom.Set.html#9060" class="Function Operator">∩</a> <a id="4450" href="Interface.IsSet.html#794" class="Function">dom</a> <a id="4454" class="Symbol">(</a><a id="4455" href="Ledger.Transaction.html#4435" class="Bound">utxo</a> <a id="4460" href="Axiom.Set.Map.html#7506" class="Function Operator">↾&#39;</a> <a id="4463" href="Ledger.Prelude.html#1675" class="Function">to-sp</a> <a id="4469" class="Symbol">(</a><a id="4470" href="Ledger.Address.html#2459" class="Function">isVKeyAddr?</a> <a id="4482" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="4484" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="4489" class="Symbol">))</a>
<a id="4492" class="Markup">\end{code}</a><a id="4502" class="Background">
\end{figure*}
</a><a id="4517" class="Markup">\begin{code}[hide]</a>
  <a id="4538" class="Keyword">instance</a>
    <a id="TransactionStructure.HasCoin-TxOut"></a><a id="4551" href="Ledger.Transaction.html#4551" class="Function">HasCoin-TxOut</a> <a id="4565" class="Symbol">:</a> <a id="4567" href="Ledger.Interface.HasCoin.html#124" class="Record">HasCoin</a> <a id="4575" href="Ledger.Transaction.html#2952" class="Function">TxOut</a>
    <a id="4585" href="Ledger.Transaction.html#4551" class="Function">HasCoin-TxOut</a> <a id="4599" class="Symbol">.</a><a id="4600" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="4608" class="Symbol">=</a> <a id="4610" href="Ledger.TokenAlgebra.html#924" class="Function">coin</a> <a id="4615" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="4617" href="Data.Product.Base.html#622" class="Field">proj₂</a>
<a id="4623" class="Markup">\end{code}</a><a id="4633" class="Background">
</a></pre></body></html>