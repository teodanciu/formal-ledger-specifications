<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.DeriveComp</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">-v</a> <a id="16" class="Pragma">allTactics:100</a> <a id="31" class="Symbol">#-}</a>
<a id="35" class="Symbol">{-#</a> <a id="39" class="Keyword">OPTIONS</a> <a id="47" class="Pragma">--safe</a> <a id="54" class="Symbol">#-}</a>
<a id="58" class="Keyword">module</a> <a id="65" href="Tactic.DeriveComp.html" class="Module">Tactic.DeriveComp</a> <a id="83" class="Keyword">where</a>

<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Prelude.html" class="Module">Prelude</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Meta.html" class="Module">Meta</a>

<a id="128" class="Keyword">import</a> <a id="135" href="Reflection.html" class="Module">Reflection</a> <a id="146" class="Symbol">as</a> <a id="149" class="Module">R</a>
<a id="151" class="Keyword">import</a> <a id="158" href="Reflection.AST.Argument.Visibility.html" class="Module">Reflection.AST.Argument.Visibility</a> <a id="193" class="Symbol">as</a> <a id="196" class="Module">Visibility</a>
<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Reflection.AST.DeBruijn.html" class="Module">Reflection.AST.DeBruijn</a>

<a id="244" class="Keyword">import</a> <a id="251" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="270" class="Symbol">as</a> <a id="273" class="Module">NE</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Data.Maybe.Properties.html" class="Module">Data.Maybe.Properties</a> <a id="310" class="Keyword">using</a> <a id="316" class="Symbol">(</a><a id="317" href="Data.Maybe.Properties.html#947" class="Function">just-injective</a><a id="331" class="Symbol">)</a>
<a id="333" class="Keyword">import</a> <a id="340" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="354" class="Symbol">as</a> <a id="357" class="Module">ℕ</a>

<a id="360" class="Keyword">open</a> <a id="365" class="Keyword">import</a> <a id="372" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a>
<a id="427" class="Keyword">open</a> <a id="432" class="Keyword">import</a> <a id="439" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="467" class="Keyword">open</a> <a id="472" class="Keyword">import</a> <a id="479" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="500" class="Keyword">open</a> <a id="505" class="Keyword">import</a> <a id="512" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Tactic.ReduceDec.html" class="Module">Tactic.ReduceDec</a>
<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Generics.Core.html" class="Module">Generics.Core</a>
<a id="582" class="Keyword">open</a> <a id="587" class="Keyword">import</a> <a id="594" href="Generics.html" class="Module">Generics</a> <a id="603" class="Keyword">hiding</a> <a id="610" class="Symbol">(</a><a id="611" href="Generics.Debug.html#961" class="Function">error</a><a id="616" class="Symbol">;</a> <a id="618" href="Generics.Utils.html#7510" class="Function">mkRecord</a><a id="626" class="Symbol">)</a>
<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">import</a> <a id="640" href="Interface.ComputationalRelation.html" class="Module">Interface.ComputationalRelation</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Interface.DecEq.html" class="Module">Interface.DecEq</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Interface.Decidable.Instance.html" class="Module">Interface.Decidable.Instance</a>
<a id="741" class="Keyword">open</a> <a id="746" class="Keyword">import</a> <a id="753" href="Interface.HasAdd.html" class="Module">Interface.HasAdd</a>
<a id="770" class="Keyword">open</a> <a id="775" class="Keyword">import</a> <a id="782" href="Interface.HasAdd.Instance.html" class="Module">Interface.HasAdd.Instance</a>

<a id="809" class="Keyword">open</a> <a id="814" class="Keyword">import</a> <a id="821" href="Interface.Monad.Instance.html" class="Module">Interface.Monad.Instance</a>
<a id="846" class="Keyword">open</a> <a id="851" class="Keyword">import</a> <a id="858" href="Interface.MonadReader.Instance.html" class="Module">Interface.MonadReader.Instance</a>
<a id="889" class="Keyword">open</a> <a id="894" class="Keyword">import</a> <a id="901" href="Interface.MonadError.Instance.html" class="Module">Interface.MonadError.Instance</a>
<a id="931" class="Keyword">open</a> <a id="936" class="Keyword">import</a> <a id="943" href="Interface.MonadTC.Instance.html" class="Module">Interface.MonadTC.Instance</a>

<a id="971" class="Keyword">open</a> <a id="976" class="Keyword">import</a> <a id="983" href="Interface.HasSubtract.html" class="Module">Interface.HasSubtract</a>
<a id="1005" class="Keyword">open</a> <a id="1010" class="Keyword">import</a> <a id="1017" href="Interface.HasSubtract.Instance.html" class="Module">Interface.HasSubtract.Instance</a>

<a id="1049" class="Keyword">pattern</a> <a id="``yes"></a><a id="1057" href="Tactic.DeriveComp.html#1057" class="InductiveConstructor">``yes</a> <a id="1063" href="Tactic.DeriveComp.html#1115" class="Bound">x</a> <a id="1065" class="Symbol">=</a> <a id="1067" class="Keyword">quote</a> <a id="1073" href="Relation.Nullary.Decidable.Core.html#1524" class="InductiveConstructor Operator">_because_</a> <a id="1083" href="Generics.Core.html#2284" class="InductiveConstructor Operator">◇⟦</a> <a id="1086" class="Keyword">quote</a> <a id="1092" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a> <a id="1097" href="Generics.Core.html#2204" class="InductiveConstructor Operator">◇</a>  <a id="1100" href="Generics.Core.html#2284" class="InductiveConstructor Operator">∣</a> <a id="1102" class="Keyword">quote</a> <a id="1108" href="Relation.Nullary.Reflects.html#938" class="InductiveConstructor">ofʸ</a> <a id="1112" href="Generics.Core.html#2236" class="InductiveConstructor Operator">◇⟦</a> <a id="1115" href="Tactic.DeriveComp.html#1115" class="Bound">x</a> <a id="1117" href="Generics.Core.html#2236" class="InductiveConstructor Operator">⟧</a> <a id="1119" href="Generics.Core.html#2284" class="InductiveConstructor Operator">⟧</a>
<a id="1121" class="Keyword">pattern</a> <a id="``no"></a><a id="1129" href="Tactic.DeriveComp.html#1129" class="InductiveConstructor">``no</a> <a id="1134" href="Tactic.DeriveComp.html#1187" class="Bound">x</a>  <a id="1137" class="Symbol">=</a> <a id="1139" class="Keyword">quote</a> <a id="1145" href="Relation.Nullary.Decidable.Core.html#1524" class="InductiveConstructor Operator">_because_</a> <a id="1155" href="Generics.Core.html#2284" class="InductiveConstructor Operator">◇⟦</a> <a id="1158" class="Keyword">quote</a> <a id="1164" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1170" href="Generics.Core.html#2204" class="InductiveConstructor Operator">◇</a> <a id="1172" href="Generics.Core.html#2284" class="InductiveConstructor Operator">∣</a> <a id="1174" class="Keyword">quote</a> <a id="1180" href="Relation.Nullary.Reflects.html#975" class="InductiveConstructor">ofⁿ</a> <a id="1184" href="Generics.Core.html#2236" class="InductiveConstructor Operator">◇⟦</a> <a id="1187" href="Tactic.DeriveComp.html#1187" class="Bound">x</a> <a id="1189" href="Generics.Core.html#2236" class="InductiveConstructor Operator">⟧</a> <a id="1191" href="Generics.Core.html#2284" class="InductiveConstructor Operator">⟧</a>

<a id="1194" class="Keyword">instance</a>
  <a id="1205" href="Tactic.DeriveComp.html#1205" class="Function">_</a> <a id="1207" class="Symbol">=</a> <a id="1209" href="Tactic.ClauseBuilder.html#10635" class="Function">ContextMonad-MonadTC</a>

<a id="1231" class="Keyword">record</a> <a id="STSConstr"></a><a id="1238" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a> <a id="1248" class="Symbol">:</a> <a id="1250" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1254" class="Keyword">where</a>
  <a id="1262" class="Keyword">field</a>
    <a id="STSConstr.name"></a><a id="1272" href="Tactic.DeriveComp.html#1272" class="Field">name</a>    <a id="1280" class="Symbol">:</a> <a id="1282" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
    <a id="STSConstr.params"></a><a id="1291" href="Tactic.DeriveComp.html#1291" class="Field">params</a>  <a id="1299" class="Symbol">:</a> <a id="1301" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1306" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1308" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1312" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1314" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1318" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
    <a id="STSConstr.clauses"></a><a id="1327" href="Tactic.DeriveComp.html#1327" class="Field">clauses</a> <a id="1335" class="Symbol">:</a> <a id="1337" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1342" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
    <a id="STSConstr.context"></a><a id="1351" href="Tactic.DeriveComp.html#1351" class="Field">context</a> <a id="1359" class="Symbol">:</a> <a id="1361" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
    <a id="STSConstr.state"></a><a id="1373" href="Tactic.DeriveComp.html#1373" class="Field">state</a>   <a id="1381" class="Symbol">:</a> <a id="1383" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
    <a id="STSConstr.signal"></a><a id="1395" href="Tactic.DeriveComp.html#1395" class="Field">signal</a>  <a id="1403" class="Symbol">:</a> <a id="1405" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
    <a id="STSConstr.result"></a><a id="1417" href="Tactic.DeriveComp.html#1417" class="Field">result</a>  <a id="1425" class="Symbol">:</a> <a id="1427" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>

<a id="conOrVarToPattern"></a><a id="1433" href="Tactic.DeriveComp.html#1433" class="Function">conOrVarToPattern</a> <a id="1451" class="Symbol">:</a> <a id="1453" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1455" class="Symbol">→</a> <a id="1457" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1462" class="Symbol">→</a> <a id="1464" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1470" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
<a id="1478" href="Tactic.DeriveComp.html#1433" class="Function">conOrVarToPattern</a> <a id="1496" href="Tactic.DeriveComp.html#1496" class="Bound">k</a> <a id="1498" class="Symbol">(</a><a id="1499" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="1501" href="Tactic.DeriveComp.html#1501" class="Bound">v</a><a id="1502" class="Symbol">)</a> <a id="1504" class="Symbol">=</a> <a id="1506" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1511" class="Symbol">(</a><a id="1512" href="Agda.Builtin.Reflection.html#5584" class="InductiveConstructor">Pattern.var</a> <a id="1524" class="Symbol">(</a><a id="1525" href="Tactic.DeriveComp.html#1501" class="Bound">v</a> <a id="1527" href="Interface.HasSubtract.html#145" class="Field Operator">-</a> <a id="1529" href="Tactic.DeriveComp.html#1496" class="Bound">k</a><a id="1530" class="Symbol">))</a>
<a id="1533" href="Tactic.DeriveComp.html#1433" class="Function">conOrVarToPattern</a> <a id="1551" href="Tactic.DeriveComp.html#1551" class="Bound">k</a> <a id="1553" class="Symbol">(</a><a id="1554" href="Agda.Builtin.Reflection.html#4871" class="InductiveConstructor">con</a> <a id="1558" href="Tactic.DeriveComp.html#1558" class="Bound">c</a> <a id="1560" href="Tactic.DeriveComp.html#1560" class="Bound">args</a><a id="1564" class="Symbol">)</a> <a id="1566" class="Symbol">=</a>
  <a id="1570" href="Agda.Builtin.Reflection.html#5491" class="InductiveConstructor">Pattern.con</a> <a id="1582" href="Tactic.DeriveComp.html#1558" class="Bound">c</a> <a id="1584" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="1588" class="Symbol">(</a><a id="1589" href="Interface.Monad.html#975" class="Function">sequenceList</a> <a id="1602" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1604" href="Tactic.DeriveComp.html#1643" class="Function">conOrVarToPattern′</a> <a id="1623" href="Tactic.DeriveComp.html#1551" class="Bound">k</a> <a id="1625" href="Tactic.DeriveComp.html#1560" class="Bound">args</a><a id="1629" class="Symbol">)</a>
  <a id="1633" class="Keyword">where</a>
    <a id="1643" href="Tactic.DeriveComp.html#1643" class="Function">conOrVarToPattern′</a> <a id="1662" class="Symbol">:</a> <a id="1664" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1666" class="Symbol">→</a> <a id="1668" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1678" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="1682" class="Symbol">)</a> <a id="1684" class="Symbol">→</a> <a id="1686" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1691" class="Symbol">(</a><a id="1692" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1698" class="Symbol">(</a><a id="1699" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1703" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a><a id="1710" class="Symbol">))</a>
    <a id="1717" href="Tactic.DeriveComp.html#1643" class="Function">conOrVarToPattern′</a> <a id="1736" href="Tactic.DeriveComp.html#1736" class="Bound">k</a> <a id="1738" class="Symbol">=</a> <a id="1740" class="Symbol">λ</a> <a id="1742" class="Keyword">where</a>
      <a id="1754" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1757" class="Symbol">→</a> <a id="1759" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
      <a id="1768" class="Symbol">((</a><a id="1770" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1774" href="Tactic.DeriveComp.html#1774" class="Bound">i</a> <a id="1776" href="Tactic.DeriveComp.html#1776" class="Bound">x</a><a id="1777" class="Symbol">)</a> <a id="1779" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1781" href="Tactic.DeriveComp.html#1781" class="Bound">l</a><a id="1782" class="Symbol">)</a> <a id="1784" class="Symbol">→</a> <a id="1786" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1790" href="Tactic.DeriveComp.html#1774" class="Bound">i</a> <a id="1792" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="1796" href="Tactic.DeriveComp.html#1433" class="Function">conOrVarToPattern</a> <a id="1814" href="Tactic.DeriveComp.html#1736" class="Bound">k</a> <a id="1816" href="Tactic.DeriveComp.html#1776" class="Bound">x</a> <a id="1818" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1820" href="Tactic.DeriveComp.html#1643" class="Function">conOrVarToPattern′</a> <a id="1839" href="Tactic.DeriveComp.html#1736" class="Bound">k</a> <a id="1841" href="Tactic.DeriveComp.html#1781" class="Bound">l</a>
<a id="1843" href="Tactic.DeriveComp.html#1433" class="CatchallClause Function">conOrVarToPattern</a><a id="1860" class="CatchallClause"> </a><a id="1861" class="CatchallClause Symbol">_</a><a id="1862" class="CatchallClause"> </a><a id="1863" class="CatchallClause Symbol">_</a> <a id="1865" class="Symbol">=</a> <a id="1867" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

<a id="isArg"></a><a id="1876" href="Tactic.DeriveComp.html#1876" class="Function">isArg</a> <a id="1882" class="Symbol">:</a> <a id="1884" class="Symbol">(</a><a id="1885" href="Tactic.DeriveComp.html#1885" class="Bound">a</a> <a id="1887" class="Symbol">:</a> <a id="1889" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1893" class="Symbol">(</a><a id="1894" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1898" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="1902" class="Symbol">))</a> <a id="1905" class="Symbol">→</a> <a id="1907" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1911" class="Symbol">_</a>
<a id="1913" href="Tactic.DeriveComp.html#1876" class="Function">isArg</a> <a id="1919" href="Tactic.DeriveComp.html#1919" class="Bound">a</a> <a id="1921" class="Symbol">=</a> <a id="1923" href="Relation.Nullary.Decidable.Core.html#2163" class="Function">¬?</a> <a id="1926" class="Symbol">(</a><a id="1927" href="Generics.Utils.html#1154" class="Function">getVisibility</a> <a id="1941" class="Symbol">(</a><a id="1942" href="Reflection.AST.Abstraction.html#1701" class="Function">unAbs</a> <a id="1948" href="Tactic.DeriveComp.html#1919" class="Bound">a</a><a id="1949" class="Symbol">)</a> <a id="1951" href="Reflection.AST.Argument.Visibility.html#821" class="Function Operator">Visibility.≟</a> <a id="1964" href="Agda.Builtin.Reflection.html#2745" class="InductiveConstructor">visible</a><a id="1971" class="Symbol">)</a>

<a id="toSTSConstr"></a><a id="1974" href="Tactic.DeriveComp.html#1974" class="Function">toSTSConstr</a> <a id="1986" class="Symbol">:</a> <a id="1988" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1993" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1995" href="Generics.Utils.html#2580" class="Function">TypeView</a> <a id="2004" class="Symbol">→</a> <a id="2006" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="2009" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a>
<a id="2019" href="Tactic.DeriveComp.html#1974" class="Function">toSTSConstr</a> <a id="2031" class="Symbol">(</a><a id="2032" href="Tactic.DeriveComp.html#2032" class="Bound">n</a> <a id="2034" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2036" class="Symbol">(</a><a id="2037" href="Tactic.DeriveComp.html#2037" class="Bound">cs</a> <a id="2040" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2042" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="2046" class="Symbol">_</a> <a id="2048" href="Tactic.DeriveComp.html#2048" class="Bound">args</a><a id="2052" class="Symbol">))</a>
  <a id="2057" class="Keyword">with</a> <a id="2062" href="Tactic.DeriveComp.html#2048" class="Bound">args</a> <a id="2067" class="Symbol">|</a> <a id="2069" href="Data.List.Base.html#1691" class="Function">mapMaybe</a> <a id="2078" class="Symbol">(</a><a id="2079" href="Tactic.DeriveComp.html#1433" class="Function">conOrVarToPattern</a> <a id="2097" class="Symbol">(</a><a id="2098" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2105" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2107" href="Data.List.Base.html#11303" class="Function">dropWhile</a> <a id="2117" href="Tactic.DeriveComp.html#1876" class="Function">isArg</a> <a id="2123" href="Tactic.DeriveComp.html#2037" class="Bound">cs</a><a id="2125" class="Symbol">)</a> <a id="2127" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="2129" href="Reflection.AST.Argument.html#2624" class="Function">unArg</a><a id="2134" class="Symbol">)</a>
                       <a id="2159" class="Symbol">(</a><a id="2160" href="Data.List.Base.html#8449" class="Function">take</a> <a id="2165" class="Number">3</a> <a id="2167" href="Tactic.DeriveComp.html#2048" class="Bound">args</a><a id="2171" class="Symbol">)</a>
<a id="2173" class="Symbol">...</a> <a id="2177" class="Symbol">|</a> <a id="2179" class="Symbol">_</a> <a id="2181" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2183" class="Symbol">_</a> <a id="2185" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2187" class="Symbol">_</a> <a id="2189" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2191" href="Tactic.DeriveComp.html#2191" class="Bound">r</a> <a id="2193" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2195" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2198" class="Symbol">|</a> <a id="2200" href="Tactic.DeriveComp.html#2200" class="Bound">c</a> <a id="2202" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2204" href="Tactic.DeriveComp.html#2204" class="Bound">s</a> <a id="2206" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2208" href="Tactic.DeriveComp.html#2208" class="Bound">sig</a> <a id="2212" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2214" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2217" class="Symbol">=</a>
  <a id="2221" href="Interface.Monad.html#290" class="Field">return</a> <a id="2228" class="Keyword">record</a>
    <a id="2239" class="Symbol">{</a> <a id="2241" href="Tactic.DeriveComp.html#1272" class="Field">name</a> <a id="2246" class="Symbol">=</a> <a id="2248" class="Bound">n</a>
    <a id="2254" class="Symbol">;</a> <a id="2256" href="Tactic.DeriveComp.html#1291" class="Field">params</a> <a id="2263" class="Symbol">=</a> <a id="2265" href="Data.List.Base.html#11203" class="Function">takeWhile</a> <a id="2275" href="Tactic.DeriveComp.html#1876" class="Function">isArg</a> <a id="2281" class="Bound">cs</a>
    <a id="2288" class="Symbol">;</a> <a id="2290" href="Tactic.DeriveComp.html#1327" class="Field">clauses</a> <a id="2298" class="Symbol">=</a> <a id="2300" href="Tactic.Helpers.html#640" class="Function">zipWithIndex</a> <a id="2313" class="Symbol">(λ</a> <a id="2316" href="Tactic.DeriveComp.html#2316" class="Bound">i</a> <a id="2318" class="Symbol">→</a> <a id="2320" href="Generics.Utils.html#5759" class="Function">mapVars</a> <a id="2328" class="Symbol">(</a><a id="2329" href="Interface.HasSubtract.html#145" class="Field Operator">_-</a> <a id="2332" href="Tactic.DeriveComp.html#2316" class="Bound">i</a><a id="2333" class="Symbol">))</a>
              <a id="2350" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2352" class="Symbol">(</a><a id="2353" href="Reflection.AST.Argument.html#2624" class="Function">unArg</a> <a id="2359" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="2361" href="Reflection.AST.Abstraction.html#1701" class="Function">unAbs</a><a id="2366" class="Symbol">)</a> <a id="2368" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="2372" href="Data.List.Base.html#11303" class="Function">dropWhile</a> <a id="2382" href="Tactic.DeriveComp.html#1876" class="Function">isArg</a> <a id="2388" class="Bound">cs</a>
    <a id="2395" class="Symbol">;</a> <a id="2397" href="Tactic.DeriveComp.html#1351" class="Field">context</a> <a id="2405" class="Symbol">=</a> <a id="2407" href="Tactic.DeriveComp.html#2200" class="Bound">c</a>
    <a id="2413" class="Symbol">;</a> <a id="2415" href="Tactic.DeriveComp.html#1373" class="Field">state</a> <a id="2421" class="Symbol">=</a> <a id="2423" href="Tactic.DeriveComp.html#2204" class="Bound">s</a>
    <a id="2429" class="Symbol">;</a> <a id="2431" href="Tactic.DeriveComp.html#1395" class="Field">signal</a> <a id="2438" class="Symbol">=</a> <a id="2440" href="Tactic.DeriveComp.html#2208" class="Bound">sig</a>
    <a id="2448" class="Symbol">;</a> <a id="2450" href="Tactic.DeriveComp.html#1417" class="Field">result</a> <a id="2457" class="Symbol">=</a> <a id="2459" href="Generics.Utils.html#5759" class="Function">mapVars</a> <a id="2467" class="Symbol">(</a><a id="2468" href="Interface.HasSubtract.html#145" class="Field Operator">_-</a> <a id="2471" class="Symbol">(</a><a id="2472" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2479" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2481" href="Data.List.Base.html#11303" class="Function">dropWhile</a> <a id="2491" href="Tactic.DeriveComp.html#1876" class="Function">isArg</a> <a id="2497" class="Bound">cs</a><a id="2499" class="Symbol">))</a> <a id="2502" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2504" href="Reflection.AST.Argument.html#2624" class="Function">unArg</a> <a id="2510" href="Tactic.DeriveComp.html#2191" class="Bound">r</a> <a id="2512" class="Symbol">}</a>
<a id="2514" class="CatchallClause Symbol">...</a><a id="2517" class="CatchallClause"> </a><a id="2518" class="CatchallClause Symbol">|</a><a id="2519" class="CatchallClause"> </a><a id="2520" href="Tactic.DeriveComp.html#2520" class="CatchallClause Bound">l</a><a id="2521" class="CatchallClause"> </a><a id="2522" class="CatchallClause Symbol">|</a><a id="2523" class="CatchallClause"> </a><a id="2524" href="Tactic.DeriveComp.html#2524" class="CatchallClause Bound">l&#39;</a> <a id="2527" class="Symbol">=</a>
  <a id="2531" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="2538" class="Symbol">(</a><a id="2539" class="String">&quot;toSTSConstr: wrong number of arguments:&quot;</a>
    <a id="2585" href="Data.String.Base.html#3047" class="Function Operator">&lt;+&gt;</a> <a id="2589" href="Data.Nat.Show.html#1924" class="Function">ℕ.show</a> <a id="2596" class="Symbol">(</a><a id="2597" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2604" href="Tactic.DeriveComp.html#2520" class="Bound">l</a><a id="2605" class="Symbol">)</a> <a id="2607" href="Data.String.Base.html#3047" class="Function Operator">&lt;+&gt;</a> <a id="2611" class="String">&quot;,&quot;</a> <a id="2615" href="Data.String.Base.html#3047" class="Function Operator">&lt;+&gt;</a> <a id="2619" href="Data.Nat.Show.html#1924" class="Function">ℕ.show</a> <a id="2626" class="Symbol">(</a><a id="2627" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2634" href="Tactic.DeriveComp.html#2524" class="Bound">l&#39;</a><a id="2636" class="Symbol">))</a>
<a id="2639" href="Tactic.DeriveComp.html#1974" class="CatchallClause Function">toSTSConstr</a><a id="2650" class="CatchallClause"> </a><a id="2651" class="CatchallClause Symbol">_</a> <a id="2653" class="Symbol">=</a> <a id="2655" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="2662" class="String">&quot;toSTSConstr: wrong constructor&quot;</a>

<a id="errorIfNothing"></a><a id="2696" href="Tactic.DeriveComp.html#2696" class="Function">errorIfNothing</a> <a id="2711" class="Symbol">:</a> <a id="2713" class="Symbol">∀</a> <a id="2715" class="Symbol">{</a><a id="2716" href="Tactic.DeriveComp.html#2716" class="Bound">a</a><a id="2717" class="Symbol">}</a> <a id="2719" class="Symbol">{</a><a id="2720" href="Tactic.DeriveComp.html#2720" class="Bound">A</a> <a id="2722" class="Symbol">:</a> <a id="2724" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="2728" href="Tactic.DeriveComp.html#2716" class="Bound">a</a><a id="2729" class="Symbol">}</a> <a id="2731" class="Symbol">→</a> <a id="2733" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2739" href="Tactic.DeriveComp.html#2720" class="Bound">A</a> <a id="2741" class="Symbol">→</a> <a id="2743" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2750" class="Symbol">→</a> <a id="2752" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="2755" href="Tactic.DeriveComp.html#2720" class="Bound">A</a>
<a id="2757" href="Tactic.DeriveComp.html#2696" class="Function">errorIfNothing</a> <a id="2772" class="Symbol">(</a><a id="2773" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2778" href="Tactic.DeriveComp.html#2778" class="Bound">x</a><a id="2779" class="Symbol">)</a> <a id="2781" href="Tactic.DeriveComp.html#2781" class="Bound">s</a> <a id="2783" class="Symbol">=</a> <a id="2785" href="Interface.Monad.html#290" class="Field">return</a> <a id="2792" href="Tactic.DeriveComp.html#2778" class="Bound">x</a>
<a id="2794" href="Tactic.DeriveComp.html#2696" class="Function">errorIfNothing</a> <a id="2809" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="2817" href="Tactic.DeriveComp.html#2817" class="Bound">s</a> <a id="2819" class="Symbol">=</a> <a id="2821" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="2828" href="Tactic.DeriveComp.html#2817" class="Bound">s</a>

<a id="getSTSConstrs"></a><a id="2831" href="Tactic.DeriveComp.html#2831" class="Function">getSTSConstrs</a> <a id="2845" class="Symbol">:</a> <a id="2847" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2852" class="Symbol">→</a> <a id="2854" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="2857" class="Symbol">(</a><a id="2858" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2863" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a><a id="2872" class="Symbol">)</a>
<a id="2874" href="Tactic.DeriveComp.html#2831" class="Function">getSTSConstrs</a> <a id="2888" href="Tactic.DeriveComp.html#2888" class="Bound">n</a> <a id="2890" class="Symbol">=</a> <a id="2892" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="2904" class="String">&quot;getSTSConstrs&quot;</a> <a id="2920" class="Keyword">do</a>
  <a id="2925" href="Tactic.DeriveComp.html#2925" class="Bound">dataDef</a> <a id="2933" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="2935" href="Tactic.Helpers.html#3182" class="Function">getDataDef</a> <a id="2946" href="Tactic.DeriveComp.html#2888" class="Bound">n</a>
  <a id="2950" href="Tactic.DeriveComp.html#2950" class="Bound">res</a> <a id="2954" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="2956" href="Interface.Monad.html#824" class="Function">traverseList</a> <a id="2969" href="Tactic.DeriveComp.html#1974" class="Function">toSTSConstr</a> <a id="2981" class="Symbol">(</a><a id="2982" href="Tactic.Helpers.html#790" class="Field">DataDef.constructors</a> <a id="3003" href="Tactic.DeriveComp.html#2925" class="Bound">dataDef</a><a id="3010" class="Symbol">)</a>
  <a id="3014" href="Interface.MonadTC.html#5865" class="Function">debugLogᵐ</a> <a id="3024" class="Symbol">(</a><a id="3025" href="Tactic.DeriveComp.html#2950" class="Bound">res</a> <a id="3029" href="Interface.MonadTC.html#5351" class="Function Operator">ᵛⁿ</a> <a id="3032" href="Interface.MonadTC.html#5134" class="Function Operator">∷ᵈᵐ</a> <a id="3036" href="Interface.MonadTC.html#5071" class="Function">[]ᵐ</a><a id="3039" class="Symbol">)</a>
  <a id="3043" href="Interface.Monad.html#290" class="Field">return</a> <a id="3050" href="Tactic.DeriveComp.html#2950" class="Bound">res</a>

<a id="generatePred"></a><a id="3055" href="Tactic.DeriveComp.html#3055" class="Function">generatePred</a> <a id="3068" class="Symbol">:</a> <a id="3070" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3075" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="3080" class="Symbol">→</a> <a id="3082" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="3087" href="Tactic.DeriveComp.html#3055" class="Function">generatePred</a> <a id="3100" href="Tactic.DeriveComp.html#3100" class="Bound">clauses</a> <a id="3108" class="Symbol">=</a> <a id="3110" class="Keyword">quote</a> <a id="3116" href="Interface.Decidable.Instance.html#739" class="Function Operator">¿_¿</a> <a id="3120" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3123" href="Tactic.DeriveComp.html#3152" class="Function">helper</a> <a id="3130" href="Tactic.DeriveComp.html#3100" class="Bound">clauses</a> <a id="3138" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a>
  <a id="3142" class="Keyword">where</a>
    <a id="3152" href="Tactic.DeriveComp.html#3152" class="Function">helper</a> <a id="3159" class="Symbol">:</a> <a id="3161" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3166" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="3171" class="Symbol">→</a> <a id="3173" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
    <a id="3182" href="Tactic.DeriveComp.html#3152" class="Function">helper</a> <a id="3189" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="3192" class="Symbol">=</a> <a id="3194" class="Keyword">quoteTerm</a> <a id="3204" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
    <a id="3210" href="Tactic.DeriveComp.html#3152" class="Function">helper</a> <a id="3217" class="Symbol">(</a><a id="3218" href="Tactic.DeriveComp.html#3218" class="Bound">x</a> <a id="3220" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3222" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="3224" class="Symbol">)</a> <a id="3226" class="Symbol">=</a> <a id="3228" href="Tactic.DeriveComp.html#3218" class="Bound">x</a>
    <a id="3234" href="Tactic.DeriveComp.html#3152" class="Function">helper</a> <a id="3241" class="Symbol">(</a><a id="3242" href="Tactic.DeriveComp.html#3242" class="Bound">x</a> <a id="3244" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3246" href="Tactic.DeriveComp.html#3246" class="Bound">x₁</a> <a id="3249" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3251" href="Tactic.DeriveComp.html#3251" class="Bound">l</a><a id="3252" class="Symbol">)</a> <a id="3254" class="Symbol">=</a> <a id="3256" class="Keyword">quote</a> <a id="3262" href="Data.Product.Base.html#1109" class="Function Operator">_×_</a> <a id="3266" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="3269" href="Tactic.DeriveComp.html#3242" class="Bound">x</a> <a id="3271" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="3273" href="Tactic.DeriveComp.html#3152" class="Function">helper</a> <a id="3280" class="Symbol">(</a><a id="3281" href="Tactic.DeriveComp.html#3246" class="Bound">x₁</a> <a id="3284" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3286" href="Tactic.DeriveComp.html#3251" class="Bound">l</a><a id="3287" class="Symbol">)</a> <a id="3289" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>

<a id="predWitness"></a><a id="3292" href="Tactic.DeriveComp.html#3292" class="Function">predWitness</a> <a id="3304" class="Symbol">:</a> <a id="3306" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="3308" class="Symbol">→</a> <a id="3310" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="3315" href="Tactic.DeriveComp.html#3292" class="Function">predWitness</a> <a id="3327" class="Number">0</a> <a id="3329" class="Symbol">=</a> <a id="3331" class="Keyword">quoteTerm</a> <a id="3341" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a>
<a id="3344" href="Tactic.DeriveComp.html#3292" class="Function">predWitness</a> <a id="3356" class="Symbol">(</a><a id="3357" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3361" href="Tactic.DeriveComp.html#3361" class="Bound">n</a><a id="3362" class="Symbol">)</a> <a id="3364" class="Symbol">=</a> <a id="3366" href="Tactic.DeriveComp.html#3387" class="Function">helper</a> <a id="3373" href="Tactic.DeriveComp.html#3361" class="Bound">n</a>
  <a id="3377" class="Keyword">where</a>
    <a id="3387" href="Tactic.DeriveComp.html#3387" class="Function">helper</a> <a id="3394" class="Symbol">:</a> <a id="3396" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="3398" class="Symbol">→</a> <a id="3400" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
    <a id="3409" href="Tactic.DeriveComp.html#3387" class="Function">helper</a> <a id="3416" class="Number">0</a> <a id="3418" class="Symbol">=</a> <a id="3420" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="3422" class="Number">0</a>
    <a id="3428" href="Tactic.DeriveComp.html#3387" class="Function">helper</a> <a id="3435" class="Symbol">(</a><a id="3436" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3440" href="Tactic.DeriveComp.html#3440" class="Bound">n</a><a id="3441" class="Symbol">)</a> <a id="3443" class="Symbol">=</a> <a id="3445" class="Keyword">quote</a> <a id="3451" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,_</a> <a id="3455" href="Generics.Core.html#2150" class="InductiveConstructor Operator">◆⟦</a> <a id="3458" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="3460" class="Symbol">(</a><a id="3461" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3465" href="Tactic.DeriveComp.html#3440" class="Bound">n</a><a id="3466" class="Symbol">)</a> <a id="3468" href="Generics.Core.html#2150" class="InductiveConstructor Operator">∣</a> <a id="3470" href="Tactic.DeriveComp.html#3387" class="Function">helper</a> <a id="3477" href="Tactic.DeriveComp.html#3440" class="Bound">n</a> <a id="3479" href="Generics.Core.html#2150" class="InductiveConstructor Operator">⟧</a>

<a id="curryPredProof"></a><a id="3482" href="Tactic.DeriveComp.html#3482" class="Function">curryPredProof</a> <a id="3497" class="Symbol">:</a> <a id="3499" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="3501" class="Symbol">→</a> <a id="3503" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="3508" class="Symbol">→</a> <a id="3510" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3515" class="Symbol">(</a><a id="3516" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="3520" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="3524" class="Symbol">)</a>
<a id="3526" href="Tactic.DeriveComp.html#3482" class="Function">curryPredProof</a> <a id="3541" class="Number">0</a> <a id="3543" href="Tactic.DeriveComp.html#3543" class="Bound">t</a> <a id="3545" class="Symbol">=</a> <a id="3547" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
<a id="3550" href="Tactic.DeriveComp.html#3482" class="Function">curryPredProof</a> <a id="3565" class="Number">1</a> <a id="3567" href="Tactic.DeriveComp.html#3567" class="Bound">t</a> <a id="3569" class="Symbol">=</a> <a id="3571" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="3573" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="3578" href="Tactic.DeriveComp.html#3567" class="Bound">t</a> <a id="3580" href="Data.List.Base.html#5219" class="Function Operator">]</a>
<a id="3582" href="Tactic.DeriveComp.html#3482" class="Function">curryPredProof</a> <a id="3597" class="Number">2</a> <a id="3599" href="Tactic.DeriveComp.html#3599" class="Bound">t</a> <a id="3601" class="Symbol">=</a> <a id="3603" class="Keyword">quote</a> <a id="3609" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="3615" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3618" href="Tactic.DeriveComp.html#3599" class="Bound">t</a> <a id="3620" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="3622" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3626" class="Keyword">quote</a> <a id="3632" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="3638" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3641" href="Tactic.DeriveComp.html#3599" class="Bound">t</a> <a id="3643" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="3645" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3649" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
<a id="3652" href="Tactic.DeriveComp.html#3482" class="Function">curryPredProof</a> <a id="3667" class="Symbol">(</a><a id="3668" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3672" class="Symbol">(</a><a id="3673" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3677" class="Symbol">(</a><a id="3678" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3682" href="Tactic.DeriveComp.html#3682" class="Bound">k</a><a id="3683" class="Symbol">)))</a> <a id="3687" href="Tactic.DeriveComp.html#3687" class="Bound">t</a> <a id="3689" class="Symbol">=</a>
  <a id="3693" class="Keyword">quote</a> <a id="3699" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="3705" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3708" href="Tactic.DeriveComp.html#3687" class="Bound">t</a> <a id="3710" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="3712" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3716" href="Tactic.DeriveComp.html#3482" class="Function">curryPredProof</a> <a id="3731" class="Symbol">(</a><a id="3732" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3736" class="Symbol">(</a><a id="3737" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3741" href="Tactic.DeriveComp.html#3682" class="Bound">k</a><a id="3742" class="Symbol">))</a> <a id="3745" class="Symbol">(</a><a id="3746" class="Keyword">quote</a> <a id="3752" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="3758" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3761" href="Tactic.DeriveComp.html#3687" class="Bound">t</a> <a id="3763" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a><a id="3764" class="Symbol">)</a>

<a id="computeFunctionBody"></a><a id="3767" href="Tactic.DeriveComp.html#3767" class="Function">computeFunctionBody</a> <a id="3787" class="Symbol">:</a> <a id="3789" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="3794" class="Symbol">→</a> <a id="3796" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="3801" class="Symbol">→</a> <a id="3803" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="3808" href="Tactic.DeriveComp.html#3767" class="Function">computeFunctionBody</a> <a id="3828" href="Tactic.DeriveComp.html#3828" class="Bound">g</a> <a id="3830" href="Tactic.DeriveComp.html#3830" class="Bound">result</a> <a id="3837" class="Symbol">=</a>
  <a id="3841" class="Keyword">quote</a> <a id="3847" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="3861" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="3864" href="Tactic.DeriveComp.html#3828" class="Bound">g</a> <a id="3866" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="3868" class="Keyword">quote</a> <a id="3874" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3879" href="Generics.Core.html#2110" class="InductiveConstructor Operator">◆⟦</a> <a id="3882" href="Tactic.DeriveComp.html#3830" class="Bound">result</a> <a id="3889" href="Generics.Core.html#2110" class="InductiveConstructor Operator">⟧</a> <a id="3891" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="3893" class="Keyword">quote</a> <a id="3899" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="3907" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a> <a id="3909" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a>

<a id="generateFunctionClause"></a><a id="3912" href="Tactic.DeriveComp.html#3912" class="Function">generateFunctionClause</a> <a id="3935" class="Symbol">:</a> <a id="3937" class="Symbol">(</a><a id="3938" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3943" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="3948" class="Symbol">→</a> <a id="3950" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="3954" class="Symbol">)</a> <a id="3956" class="Symbol">→</a> <a id="3958" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a> <a id="3968" class="Symbol">→</a> <a id="3970" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a>
<a id="3977" href="Tactic.DeriveComp.html#3912" class="Function">generateFunctionClause</a> <a id="4000" href="Tactic.DeriveComp.html#4000" class="Bound">genPred</a> <a id="4008" href="Tactic.DeriveComp.html#4008" class="Bound">c</a> <a id="4010" class="Symbol">=</a> <a id="4012" class="Keyword">let</a> <a id="4016" class="Keyword">open</a> <a id="4021" href="Tactic.DeriveComp.html#1238" class="Module">STSConstr</a> <a id="4031" href="Tactic.DeriveComp.html#4008" class="Bound">c</a> <a id="4033" class="Keyword">in</a>
  <a id="4038" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⟦</a> <a id="4040" href="Tactic.DeriveComp.html#1351" class="Field">context</a> <a id="4048" href="Generics.Core.html#1059" class="InductiveConstructor Operator">∣</a> <a id="4050" href="Tactic.DeriveComp.html#1373" class="Field">state</a> <a id="4056" href="Generics.Core.html#1059" class="InductiveConstructor Operator">∣</a> <a id="4058" href="Tactic.DeriveComp.html#1395" class="Field">signal</a> <a id="4065" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⦅</a> <a id="4067" class="Symbol">(λ</a> <a id="4070" class="Symbol">{</a> <a id="4072" class="Symbol">(</a><a id="4073" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="4077" href="Tactic.DeriveComp.html#4077" class="Bound">s</a> <a id="4079" href="Tactic.DeriveComp.html#4079" class="Bound">x</a><a id="4080" class="Symbol">)</a> <a id="4082" class="Symbol">→</a> <a id="4084" class="Symbol">(</a><a id="4085" href="Tactic.DeriveComp.html#4077" class="Bound">s</a> <a id="4087" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4089" href="Tactic.DeriveComp.html#4079" class="Bound">x</a><a id="4090" class="Symbol">)</a> <a id="4092" class="Symbol">})</a> <a id="4095" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="4099" href="Tactic.DeriveComp.html#1291" class="Field">params</a> <a id="4106" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⦆⇒</a>
    <a id="4113" href="Tactic.DeriveComp.html#3767" class="Function">computeFunctionBody</a> <a id="4133" class="Symbol">(</a><a id="4134" class="Keyword">quote</a> <a id="4140" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌊_⌋</a> <a id="4144" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="4147" href="Tactic.DeriveComp.html#4000" class="Bound">genPred</a> <a id="4155" href="Tactic.DeriveComp.html#1327" class="Field">clauses</a> <a id="4163" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a><a id="4164" class="Symbol">)</a> <a id="4166" href="Tactic.DeriveComp.html#1417" class="Field">result</a> <a id="4173" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⟧</a>

<a id="generateFunction"></a><a id="4176" href="Tactic.DeriveComp.html#4176" class="Function">generateFunction</a> <a id="4193" class="Symbol">:</a> <a id="4195" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4200" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a> <a id="4210" class="Symbol">→</a> <a id="4212" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="4217" href="Tactic.DeriveComp.html#4176" class="Function">generateFunction</a> <a id="4234" href="Tactic.DeriveComp.html#4234" class="Bound">c</a> <a id="4236" class="Symbol">=</a> <a id="4238" href="Agda.Builtin.Reflection.html#5038" class="InductiveConstructor">pat-lam</a> <a id="4246" class="Symbol">(</a><a id="4247" href="Tactic.DeriveComp.html#3912" class="Function">generateFunctionClause</a> <a id="4270" href="Tactic.DeriveComp.html#3055" class="Function">generatePred</a> <a id="4283" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="4287" href="Tactic.DeriveComp.html#4234" class="Bound">c</a><a id="4288" class="Symbol">)</a> <a id="4290" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

<a id="rdOpts"></a><a id="4294" href="Tactic.DeriveComp.html#4294" class="Function">rdOpts</a> <a id="4301" class="Symbol">:</a> <a id="4303" href="Interface.MonadTC.html#481" class="Datatype">ReductionOptions</a>
<a id="4320" href="Tactic.DeriveComp.html#4294" class="Function">rdOpts</a> <a id="4327" class="Symbol">=</a> <a id="4329" href="Interface.MonadTC.html#512" class="InductiveConstructor">onlyReduce</a> <a id="4340" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="4342" class="Keyword">quote</a> <a id="4348" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌊_⌋</a> <a id="4352" href="Data.List.Base.html#5219" class="Function Operator">]</a>

<a id="4355" class="Keyword">open</a> <a id="4360" href="Tactic.ClauseBuilder.html#10865" class="Module">ClauseExprM</a>

<a id="derive⇐"></a><a id="4373" href="Tactic.DeriveComp.html#4373" class="Function">derive⇐</a> <a id="4381" class="Symbol">:</a> <a id="4383" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4388" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a> <a id="4398" class="Symbol">→</a> <a id="4400" href="Tactic.Helpers.html#5653" class="Function">ITactic</a>
<a id="4408" href="Tactic.DeriveComp.html#4373" class="Function">derive⇐</a> <a id="4416" class="Symbol">(</a><a id="4417" class="Keyword">record</a> <a id="4424" class="Symbol">{</a> <a id="4426" href="Tactic.DeriveComp.html#1327" class="Field">clauses</a> <a id="4434" class="Symbol">=</a> <a id="4436" href="Tactic.DeriveComp.html#4436" class="Bound">clauses</a><a id="4443" class="Symbol">;</a> <a id="4445" href="Tactic.DeriveComp.html#1417" class="Field">result</a> <a id="4452" class="Symbol">=</a> <a id="4454" href="Tactic.DeriveComp.html#4454" class="Bound">result</a> <a id="4461" class="Symbol">}</a> <a id="4463" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4465" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4467" class="Symbol">)</a> <a id="4469" class="Symbol">=</a> <a id="4471" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="4483" class="String">&quot;derive⇐&quot;</a> <a id="4493" class="Keyword">do</a>
  <a id="4498" class="Symbol">(</a><a id="4499" href="Tactic.DeriveComp.html#4499" class="Bound">constrPat</a> <a id="4509" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4511" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4513" class="Symbol">)</a> <a id="4515" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="4517" href="Tactic.ClauseBuilder.html#8607" class="Function">currentTyConstrPatterns</a>
    <a id="4545" class="Keyword">where</a> <a id="4551" class="CatchallClause Symbol">_</a> <a id="4553" class="Symbol">→</a> <a id="4555" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="4562" class="String">&quot;TODO: Support more than one constructor!&quot;</a>
  <a id="4607" href="Tactic.DeriveComp.html#4607" class="Bound">expr</a> <a id="4612" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="4614" href="Tactic.ClauseBuilder.html#11735" class="Function">singleMatchExpr</a> <a id="4630" href="Tactic.DeriveComp.html#4499" class="Bound">constrPat</a> <a id="4640" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4642" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="4654" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4656" href="Interface.MonadTC.html#10808" class="Function">withGoalHole</a> <a id="4669" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4671" class="Keyword">do</a>
    <a id="4678" class="Keyword">let</a> <a id="4682" href="Tactic.DeriveComp.html#4682" class="Bound">n</a> <a id="4684" class="Symbol">=</a> <a id="4686" class="Number">1</a> <a id="4688" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="4690" href="Data.List.Base.html#5058" class="Function">length</a> <a id="4697" href="Tactic.DeriveComp.html#4436" class="Bound">clauses</a>
        <a id="4713" href="Tactic.DeriveComp.html#4713" class="Bound">pred</a> <a id="4718" class="Symbol">=</a> <a id="4720" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="4727" href="Tactic.DeriveComp.html#4682" class="Bound">n</a> <a id="4729" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4731" href="Tactic.DeriveComp.html#3055" class="Function">generatePred</a> <a id="4744" href="Tactic.DeriveComp.html#4436" class="Bound">clauses</a>
        <a id="4760" href="Tactic.DeriveComp.html#4760" class="Bound">scheme</a> <a id="4767" class="Symbol">=</a> <a id="4769" href="Generics.Core.html#1158" class="InductiveConstructor Operator">`λ</a> <a id="4772" class="String">&quot;g&quot;</a> <a id="4776" href="Generics.Core.html#1158" class="InductiveConstructor Operator">⇒</a> <a id="4778" class="Symbol">(</a><a id="4779" class="Keyword">quote</a> <a id="4785" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a> <a id="4789" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="4792" href="Tactic.DeriveComp.html#3767" class="Function">computeFunctionBody</a> <a id="4812" class="Symbol">(</a><a id="4813" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="4815" class="Number">0</a><a id="4816" class="Symbol">)</a> <a id="4818" class="Symbol">(</a><a id="4819" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="4826" class="Symbol">(</a><a id="4827" class="Number">1</a> <a id="4829" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="4831" href="Tactic.DeriveComp.html#4682" class="Bound">n</a><a id="4832" class="Symbol">)</a> <a id="4834" href="Tactic.DeriveComp.html#4454" class="Bound">result</a><a id="4840" class="Symbol">)</a>
                                      <a id="4880" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="4882" class="Keyword">quote</a> <a id="4888" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4893" href="Generics.Core.html#2110" class="InductiveConstructor Operator">◆⟦</a> <a id="4896" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="4903" class="Symbol">(</a><a id="4904" class="Number">1</a> <a id="4906" href="Interface.HasAdd.html#135" class="Field Operator">+</a> <a id="4908" href="Tactic.DeriveComp.html#4682" class="Bound">n</a><a id="4909" class="Symbol">)</a> <a id="4911" href="Tactic.DeriveComp.html#4454" class="Bound">result</a> <a id="4918" href="Generics.Core.html#2110" class="InductiveConstructor Operator">⟧</a> <a id="4920" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a><a id="4921" class="Symbol">)</a>
        <a id="4931" href="Tactic.DeriveComp.html#4931" class="Bound">eq</a> <a id="4934" class="Symbol">=</a> <a id="4936" class="Keyword">quote</a> <a id="4942" href="Tactic.ReduceDec.html#2649" class="Function">fromWitness&#39;</a> <a id="4955" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="4958" href="Tactic.DeriveComp.html#4713" class="Bound">pred</a> <a id="4963" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="4965" href="Tactic.DeriveComp.html#3292" class="Function">predWitness</a> <a id="4977" class="Symbol">(</a><a id="4978" href="Data.List.Base.html#5058" class="Function">length</a> <a id="4985" href="Tactic.DeriveComp.html#4436" class="Bound">clauses</a><a id="4992" class="Symbol">)</a> <a id="4994" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
    <a id="5000" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="5014" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5016" class="Keyword">quote</a> <a id="5022" href="Relation.Binary.PropositionalEquality.Core.html#1794" class="Function">subst</a> <a id="5028" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="5031" href="Tactic.DeriveComp.html#4760" class="Bound">scheme</a> <a id="5038" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="5040" class="Keyword">quote</a> <a id="5046" href="Relation.Binary.PropositionalEquality.Core.html#1698" class="Function">sym</a> <a id="5050" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="5053" href="Tactic.DeriveComp.html#4931" class="Bound">eq</a> <a id="5056" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="5058" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="5060" class="Keyword">quote</a> <a id="5066" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="5071" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a> <a id="5073" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a>
  <a id="5077" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="5091" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5093" href="Tactic.ClauseBuilder.html#7490" class="Function">clauseExprToPatLam</a> <a id="5112" href="Tactic.DeriveComp.html#4607" class="Bound">expr</a>
<a id="5117" href="Tactic.DeriveComp.html#4373" class="CatchallClause Function">derive⇐</a><a id="5124" class="CatchallClause"> </a><a id="5125" class="CatchallClause Symbol">_</a> <a id="5127" class="Symbol">=</a> <a id="5129" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="5136" class="String">&quot;TODO: support multiple constructors&quot;</a>

<a id="extendRawContext"></a><a id="5175" href="Tactic.DeriveComp.html#5175" class="Function">extendRawContext</a> <a id="5192" class="Symbol">:</a> <a id="5194" class="Symbol">{</a><a id="5195" href="Tactic.DeriveComp.html#5195" class="Bound">A</a> <a id="5197" class="Symbol">:</a> <a id="5199" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="5202" class="Symbol">}</a> <a id="5204" class="Symbol">→</a> <a id="5206" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5211" class="Symbol">(</a><a id="5212" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="5219" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="5221" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="5225" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a><a id="5229" class="Symbol">)</a> <a id="5231" class="Symbol">→</a> <a id="5233" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="5236" href="Tactic.DeriveComp.html#5195" class="Bound">A</a> <a id="5238" class="Symbol">→</a> <a id="5240" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="5243" href="Tactic.DeriveComp.html#5195" class="Bound">A</a>
<a id="5245" href="Tactic.DeriveComp.html#5175" class="Function">extendRawContext</a> <a id="5262" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="5265" href="Tactic.DeriveComp.html#5265" class="Bound">m</a> <a id="5267" class="Symbol">=</a> <a id="5269" href="Tactic.DeriveComp.html#5265" class="Bound">m</a>
<a id="5271" href="Tactic.DeriveComp.html#5175" class="Function">extendRawContext</a> <a id="5288" class="Symbol">((</a><a id="5290" href="Tactic.DeriveComp.html#5290" class="Bound">x</a> <a id="5292" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5294" href="Tactic.DeriveComp.html#5294" class="Bound">ty</a><a id="5296" class="Symbol">)</a> <a id="5298" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5300" href="Tactic.DeriveComp.html#5300" class="Bound">tys</a><a id="5303" class="Symbol">)</a> <a id="5305" href="Tactic.DeriveComp.html#5305" class="Bound">m</a> <a id="5307" class="Symbol">=</a> <a id="5309" href="Agda.Builtin.Reflection.html#8954" class="Postulate">R.extendContext</a> <a id="5325" href="Tactic.DeriveComp.html#5290" class="Bound">x</a> <a id="5327" href="Tactic.DeriveComp.html#5294" class="Bound">ty</a> <a id="5330" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="5332" href="Tactic.DeriveComp.html#5175" class="Function">extendRawContext</a> <a id="5349" href="Tactic.DeriveComp.html#5300" class="Bound">tys</a> <a id="5353" href="Tactic.DeriveComp.html#5305" class="Bound">m</a>

<a id="derive⇒"></a><a id="5356" href="Tactic.DeriveComp.html#5356" class="Function">derive⇒</a> <a id="5364" class="Symbol">:</a> <a id="5366" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5371" class="Symbol">→</a> <a id="5373" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5378" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a> <a id="5388" class="Symbol">→</a> <a id="5390" href="Tactic.Helpers.html#5653" class="Function">ITactic</a>
<a id="5398" href="Tactic.DeriveComp.html#5356" class="Function">derive⇒</a> <a id="5406" href="Tactic.DeriveComp.html#5406" class="Bound">n</a>
  <a id="5410" class="Symbol">(</a><a id="5411" class="Keyword">record</a> <a id="5418" class="Symbol">{</a> <a id="5420" href="Tactic.DeriveComp.html#1272" class="Field">name</a> <a id="5425" class="Symbol">=</a> <a id="5427" href="Tactic.DeriveComp.html#5427" class="Bound">stsConstrName</a> <a id="5441" class="Symbol">;</a> <a id="5443" href="Tactic.DeriveComp.html#1327" class="Field">clauses</a> <a id="5451" class="Symbol">=</a> <a id="5453" href="Tactic.DeriveComp.html#5453" class="Bound">clauses</a><a id="5460" class="Symbol">;</a> <a id="5462" href="Tactic.DeriveComp.html#1417" class="Field">result</a> <a id="5469" class="Symbol">=</a> <a id="5471" href="Tactic.DeriveComp.html#5471" class="Bound">result</a> <a id="5478" class="Symbol">}</a> <a id="5480" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="5482" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5484" class="Symbol">)</a>
  <a id="5488" class="Symbol">=</a> <a id="5490" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="5502" class="String">&quot;derive⇒&quot;</a> <a id="5512" class="Keyword">do</a>
    <a id="5519" class="Keyword">let</a> <a id="5523" href="Tactic.DeriveComp.html#5523" class="Bound">pred</a> <a id="5528" class="Symbol">=</a> <a id="5530" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="5537" class="Number">3</a> <a id="5539" class="Symbol">(</a><a id="5540" href="Tactic.DeriveComp.html#3055" class="Function">generatePred</a> <a id="5553" href="Tactic.DeriveComp.html#5453" class="Bound">clauses</a><a id="5560" class="Symbol">)</a>
    <a id="5566" href="Tactic.DeriveComp.html#5566" class="Bound">expr</a> <a id="5571" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="5573" href="Tactic.ClauseBuilder.html#12363" class="Function">introsExpr</a> <a id="5584" class="Symbol">(</a><a id="5585" href="Data.Maybe.Base.html#1921" class="Function">from-just</a> <a id="5595" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5597" href="Data.List.NonEmpty.Base.html#1834" class="Function">NE.fromList</a> <a id="5609" class="Symbol">(</a><a id="5610" class="String">&quot;h&quot;</a> <a id="5614" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5618" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5620" class="Symbol">))</a> <a id="5623" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5625" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="5637" href="Function.Base.html#1994" class="Function Operator">$</a>
      <a id="5645" href="Tactic.ClauseBuilder.html#8398" class="Function">caseMatch</a> <a id="5655" class="Symbol">(</a><a id="5656" href="Generics.Utils.html#5759" class="Function">mapVars</a> <a id="5664" class="Symbol">(</a><a id="5665" href="Interface.HasAdd.html#135" class="Field Operator">_+</a> <a id="5668" class="Number">2</a><a id="5669" class="Symbol">)</a> <a id="5671" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5673" href="Tactic.DeriveComp.html#3055" class="Function">generatePred</a> <a id="5686" href="Tactic.DeriveComp.html#5453" class="Bound">clauses</a><a id="5693" class="Symbol">)</a> <a id="5695" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5697" href="Tactic.ClauseBuilder.html#11023" class="Function">matchExprM</a>
        <a id="5716" class="Symbol">((</a><a id="5718" href="Tactic.ClauseBuilder.html#1479" class="Function">multiSinglePattern</a> <a id="5737" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="5739" class="String">&quot;&quot;</a> <a id="5742" href="Data.List.Base.html#5219" class="Function Operator">]</a> <a id="5744" class="Symbol">(</a><a id="5745" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="5750" class="Symbol">(</a><a id="5751" href="Tactic.DeriveComp.html#1129" class="InductiveConstructor">``no</a>  <a id="5757" class="Symbol">(</a><a id="5758" href="Generics.Core.html#505" class="InductiveConstructor Operator">`</a> <a id="5760" class="Number">0</a><a id="5761" class="Symbol">)))</a> <a id="5765" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5767" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="5779" class="Keyword">do</a>
          <a id="5792" class="Keyword">let</a> <a id="5796" href="Tactic.DeriveComp.html#5796" class="Bound">reducedHyp</a> <a id="5807" class="Symbol">=</a> <a id="5809" class="Keyword">quote</a> <a id="5815" href="Relation.Binary.PropositionalEquality.Core.html#1794" class="Function">subst</a>
                <a id="5837" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="5840" href="Generics.Core.html#1158" class="InductiveConstructor Operator">`λ</a> <a id="5843" class="String">&quot;g&quot;</a> <a id="5847" href="Generics.Core.html#1158" class="InductiveConstructor Operator">⇒</a> <a id="5849" class="Symbol">(</a><a id="5850" class="Keyword">quote</a> <a id="5856" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a> <a id="5860" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="5863" href="Tactic.DeriveComp.html#3767" class="Function">computeFunctionBody</a> <a id="5883" class="Symbol">(</a><a id="5884" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="5886" class="Number">0</a><a id="5887" class="Symbol">)</a> <a id="5889" class="Symbol">(</a><a id="5890" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="5897" class="Number">4</a> <a id="5899" href="Tactic.DeriveComp.html#5471" class="Bound">result</a><a id="5905" class="Symbol">)</a>
                                        <a id="5947" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="5949" class="Keyword">quote</a> <a id="5955" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="5960" href="Generics.Core.html#2110" class="InductiveConstructor Operator">◆⟦</a> <a id="5963" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="5965" class="Number">3</a> <a id="5967" href="Generics.Core.html#2110" class="InductiveConstructor Operator">⟧</a> <a id="5969" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a><a id="5970" class="Symbol">)</a>
                 <a id="5989" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="5991" class="Keyword">quote</a> <a id="5997" href="Tactic.ReduceDec.html#2783" class="Function">fromWitnessFalse&#39;</a> <a id="6015" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="6018" href="Tactic.DeriveComp.html#5523" class="Bound">pred</a> <a id="6023" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="6025" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="6027" class="Number">0</a> <a id="6029" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
                 <a id="6048" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="6050" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="6052" class="Number">1</a>
                 <a id="6071" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a>
          <a id="6083" href="Interface.Monad.html#290" class="Field">return</a> <a id="6090" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="6092" class="Keyword">quote</a> <a id="6098" href="Function.Base.html#4053" class="Function Operator">case_of_</a> <a id="6107" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="6110" href="Tactic.DeriveComp.html#5796" class="Bound">reducedHyp</a> <a id="6121" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="6123" href="Generics.Core.html#1458" class="InductiveConstructor">`λ∅</a> <a id="6127" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a><a id="6128" class="Symbol">)</a> <a id="6130" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a>
        <a id="6140" class="Symbol">(</a><a id="6141" href="Tactic.ClauseBuilder.html#1479" class="Function">multiSinglePattern</a> <a id="6160" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="6162" class="String">&quot;&quot;</a> <a id="6165" href="Data.List.Base.html#5219" class="Function Operator">]</a> <a id="6167" class="Symbol">(</a><a id="6168" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="6173" class="Symbol">(</a><a id="6174" href="Tactic.DeriveComp.html#1057" class="InductiveConstructor">``yes</a> <a id="6180" class="Symbol">(</a><a id="6181" href="Generics.Core.html#505" class="InductiveConstructor Operator">`</a> <a id="6183" class="Number">0</a><a id="6184" class="Symbol">)))</a> <a id="6188" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6190" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="6202" class="Keyword">do</a>
          <a id="6215" class="Keyword">let</a> <a id="6219" href="Tactic.DeriveComp.html#6219" class="Bound">reducedHyp</a> <a id="6230" class="Symbol">=</a> <a id="6232" class="Keyword">quote</a> <a id="6238" href="Relation.Binary.PropositionalEquality.Core.html#1794" class="Function">subst</a>
                <a id="6260" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="6263" href="Generics.Core.html#1158" class="InductiveConstructor Operator">`λ</a> <a id="6266" class="String">&quot;g&quot;</a> <a id="6270" href="Generics.Core.html#1158" class="InductiveConstructor Operator">⇒</a> <a id="6272" class="Symbol">(</a><a id="6273" class="Keyword">quote</a> <a id="6279" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a> <a id="6283" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="6286" href="Tactic.DeriveComp.html#3767" class="Function">computeFunctionBody</a> <a id="6306" class="Symbol">(</a><a id="6307" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="6309" class="Number">0</a><a id="6310" class="Symbol">)</a> <a id="6312" class="Symbol">(</a><a id="6313" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="6320" class="Number">4</a> <a id="6322" href="Tactic.DeriveComp.html#5471" class="Bound">result</a><a id="6328" class="Symbol">)</a>
                                        <a id="6370" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="6372" class="Keyword">quote</a> <a id="6378" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="6383" href="Generics.Core.html#2110" class="InductiveConstructor Operator">◆⟦</a> <a id="6386" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="6388" class="Number">3</a> <a id="6390" href="Generics.Core.html#2110" class="InductiveConstructor Operator">⟧</a> <a id="6392" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a><a id="6393" class="Symbol">)</a>
                 <a id="6412" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="6414" class="Keyword">quote</a> <a id="6420" href="Tactic.ReduceDec.html#2649" class="Function">fromWitness&#39;</a> <a id="6433" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="6436" href="Tactic.DeriveComp.html#5523" class="Bound">pred</a> <a id="6441" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="6443" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="6445" class="Number">0</a> <a id="6447" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
                 <a id="6466" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="6468" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="6470" class="Number">1</a>
                 <a id="6489" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a>
          <a id="6501" href="Tactic.DeriveComp.html#6501" class="Bound">ty</a> <a id="6504" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∙⟦</a> <a id="6507" href="Tactic.DeriveComp.html#6507" class="Bound">c</a> <a id="6509" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∣</a> <a id="6511" href="Tactic.DeriveComp.html#6511" class="Bound">s</a> <a id="6513" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∣</a> <a id="6515" href="Tactic.DeriveComp.html#6515" class="Bound">sig</a> <a id="6519" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∣</a> <a id="6521" href="Tactic.DeriveComp.html#6521" class="Bound">s&#39;</a> <a id="6524" href="Generics.Core.html#2006" class="InductiveConstructor Operator">⟧</a> <a id="6526" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="6528" href="Interface.MonadTC.html#8930" class="Function">goalTy</a>
            <a id="6547" class="Keyword">where</a> <a id="6553" href="Tactic.DeriveComp.html#6553" class="CatchallClause Bound">ty</a> <a id="6556" class="Symbol">→</a> <a id="6558" href="Interface.MonadError.html#369" class="Field">error</a> <a id="6564" class="Symbol">(</a><a id="6565" class="String">&quot;BUG: Unexpected type&quot;</a> <a id="6588" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="6591" href="Tactic.DeriveComp.html#6553" class="Bound">ty</a> <a id="6594" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="6597" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="6599" class="Symbol">)</a>
          <a id="6611" href="Interface.Monad.html#290" class="Field">return</a> <a id="6618" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="6620" class="Keyword">quote</a> <a id="6626" href="Relation.Binary.PropositionalEquality.Core.html#1794" class="Function">subst</a>
            <a id="6644" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="6647" href="Tactic.DeriveComp.html#6501" class="Bound">ty</a> <a id="6650" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="6653" href="Tactic.DeriveComp.html#6507" class="Bound">c</a> <a id="6655" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="6657" href="Tactic.DeriveComp.html#6511" class="Bound">s</a> <a id="6659" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="6661" href="Tactic.DeriveComp.html#6515" class="Bound">sig</a> <a id="6665" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a>
             <a id="6680" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="6682" class="Keyword">quote</a> <a id="6688" href="Data.Maybe.Properties.html#947" class="Function">just-injective</a> <a id="6703" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="6706" href="Tactic.DeriveComp.html#6219" class="Bound">reducedHyp</a> <a id="6717" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a>
             <a id="6732" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="6734" href="Agda.Builtin.Reflection.html#4871" class="InductiveConstructor">con</a> <a id="6738" href="Tactic.DeriveComp.html#5427" class="Bound">stsConstrName</a> <a id="6752" class="Symbol">(</a><a id="6753" href="Tactic.DeriveComp.html#3482" class="Function">curryPredProof</a> <a id="6768" class="Symbol">(</a><a id="6769" href="Data.List.Base.html#5058" class="Function">length</a> <a id="6776" href="Tactic.DeriveComp.html#5453" class="Bound">clauses</a><a id="6783" class="Symbol">)</a> <a id="6785" class="Symbol">(</a><a id="6786" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="6788" class="Number">0</a><a id="6789" class="Symbol">))</a>
             <a id="6805" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a><a id="6806" class="Symbol">)</a> <a id="6808" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="6810" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="6812" class="Symbol">)</a>
    <a id="6818" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="6832" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="6834" href="Tactic.ClauseBuilder.html#7490" class="Function">clauseExprToPatLam</a> <a id="6853" href="Tactic.DeriveComp.html#5566" class="Bound">expr</a>
<a id="6858" href="Tactic.DeriveComp.html#5356" class="CatchallClause Function">derive⇒</a><a id="6865" class="CatchallClause"> </a><a id="6866" class="CatchallClause Symbol">_</a><a id="6867" class="CatchallClause"> </a><a id="6868" class="CatchallClause Symbol">_</a> <a id="6870" class="Symbol">=</a> <a id="6872" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="6879" class="String">&quot;TODO: support multiple constructors&quot;</a>

<a id="6918" class="Keyword">module</a> <a id="6925" href="Tactic.DeriveComp.html#6925" class="Module">_</a> <a id="6927" class="Symbol">⦃</a> <a id="6929" href="Tactic.DeriveComp.html#6929" class="Bound">_</a> <a id="6931" class="Symbol">:</a> <a id="6933" href="Reflection.Debug.html#2344" class="Record">DebugOptions</a> <a id="6946" class="Symbol">⦄</a> <a id="6948" class="Keyword">where</a>
  <a id="6956" href="Tactic.DeriveComp.html#6956" class="Function">derive⇔</a> <a id="6964" class="Symbol">:</a> <a id="6966" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="6971" class="Symbol">→</a> <a id="6973" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="6978" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a> <a id="6988" class="Symbol">→</a> <a id="6990" href="Generics.Core.html#2462" class="Function">Tactic</a>
  <a id="6999" href="Tactic.DeriveComp.html#6956" class="Function">derive⇔</a> <a id="7007" href="Tactic.DeriveComp.html#7007" class="Bound">n</a> <a id="7009" href="Tactic.DeriveComp.html#7009" class="Bound">stsConstrs</a> <a id="7020" class="Symbol">=</a> <a id="7022" href="Tactic.Helpers.html#5927" class="Function">initTac</a> <a id="7030" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="7032" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="7044" class="String">&quot;derive⇔&quot;</a> <a id="7054" class="Keyword">do</a>
    <a id="7061" href="Tactic.DeriveComp.html#7061" class="Bound">hole⇒</a> <a id="7067" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7069" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="7077" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
    <a id="7089" href="Tactic.DeriveComp.html#7089" class="Bound">hole⇐</a> <a id="7095" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7097" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="7105" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
    <a id="7117" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="7131" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="7133" class="Keyword">quote</a> <a id="7139" href="Function.Bundles.html#10043" class="Function">mk⇔</a> <a id="7143" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="7146" href="Tactic.DeriveComp.html#7061" class="Bound">hole⇒</a> <a id="7152" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="7154" href="Tactic.DeriveComp.html#7089" class="Bound">hole⇐</a> <a id="7160" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
    <a id="7166" href="Interface.MonadTC.html#10492" class="Function">runWithHole</a> <a id="7178" href="Tactic.DeriveComp.html#7089" class="Bound">hole⇐</a> <a id="7184" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="7186" href="Tactic.DeriveComp.html#4373" class="Function">derive⇐</a> <a id="7194" href="Tactic.DeriveComp.html#7009" class="Bound">stsConstrs</a>
    <a id="7209" href="Interface.MonadTC.html#10492" class="Function">runWithHole</a> <a id="7221" href="Tactic.DeriveComp.html#7061" class="Bound">hole⇒</a> <a id="7227" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="7229" href="Tactic.DeriveComp.html#5356" class="Function">derive⇒</a> <a id="7237" href="Tactic.DeriveComp.html#7007" class="Bound">n</a> <a id="7239" href="Tactic.DeriveComp.html#7009" class="Bound">stsConstrs</a>

  <a id="7253" href="Tactic.DeriveComp.html#7253" class="Function">deriveComp</a> <a id="7264" class="Symbol">:</a> <a id="7266" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="7271" class="Symbol">→</a> <a id="7273" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="7278" href="Tactic.DeriveComp.html#1238" class="Record">STSConstr</a> <a id="7288" class="Symbol">→</a> <a id="7290" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="7293" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
  <a id="7297" href="Tactic.DeriveComp.html#7253" class="Function">deriveComp</a> <a id="7308" href="Tactic.DeriveComp.html#7308" class="Bound">definedType</a> <a id="7320" href="Tactic.DeriveComp.html#7320" class="Bound">stsConstrs</a> <a id="7331" class="Symbol">=</a> <a id="7333" class="Keyword">do</a>
    <a id="7340" href="Interface.MonadTC.html#5576" class="Function">debugLog</a> <a id="7349" class="Symbol">(</a><a id="7350" class="String">&quot;\nDerive computation function for: &quot;</a> <a id="7388" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="7391" href="Tactic.DeriveComp.html#7308" class="Bound">definedType</a> <a id="7403" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="7406" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="7408" class="Symbol">)</a>
    <a id="7414" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="7428" class="Symbol">(</a><a id="7429" href="Tactic.DeriveComp.html#4176" class="Function">generateFunction</a> <a id="7446" href="Tactic.DeriveComp.html#7320" class="Bound">stsConstrs</a><a id="7456" class="Symbol">)</a>

  <a id="7461" href="Tactic.DeriveComp.html#7461" class="Function">deriveComputational</a> <a id="7481" class="Symbol">:</a> <a id="7483" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="7488" class="Symbol">→</a> <a id="7490" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="7495" class="Symbol">→</a> <a id="7497" href="Generics.Core.html#2484" class="Function">UnquoteDecl</a>
  <a id="7511" href="Tactic.DeriveComp.html#7461" class="Function">deriveComputational</a> <a id="7531" href="Tactic.DeriveComp.html#7531" class="Bound">n</a> <a id="7533" href="Tactic.DeriveComp.html#7533" class="Bound">compName</a> <a id="7542" class="Symbol">=</a>
    <a id="7548" href="Tactic.Helpers.html#6018" class="Function">initUnquoteWithGoal</a> <a id="7568" class="Symbol">(</a><a id="7569" class="Keyword">quoteTerm</a> <a id="7579" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="7583" class="Symbol">)</a> <a id="7585" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="7587" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="7599" class="String">&quot;deriveComputational&quot;</a> <a id="7621" class="Keyword">do</a>
      <a id="7630" class="Keyword">let</a> <a id="7634" href="Tactic.DeriveComp.html#7634" class="Bound">goalTy</a> <a id="7641" class="Symbol">=</a> <a id="7643" class="Keyword">quote</a> <a id="7649" href="Interface.ComputationalRelation.html#627" class="Record">Computational</a> <a id="7663" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="7666" href="Tactic.DeriveComp.html#7531" class="Bound">n</a> <a id="7668" href="Generics.Core.html#1823" class="InductiveConstructor Operator">∙</a> <a id="7670" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a>
      <a id="7678" href="Interface.MonadTC.html#8620" class="Function">debugLog1</a> <a id="7688" href="Tactic.DeriveComp.html#7634" class="Bound">goalTy</a>
      <a id="7701" href="Interface.MonadTC.html#1932" class="Field">declareDef</a> <a id="7712" class="Symbol">(</a><a id="7713" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="7718" href="Tactic.DeriveComp.html#7533" class="Bound">compName</a><a id="7726" class="Symbol">)</a> <a id="7728" href="Tactic.DeriveComp.html#7634" class="Bound">goalTy</a>
      <a id="7741" href="Tactic.DeriveComp.html#7741" class="Bound">stsConstrs</a> <a id="7752" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7754" href="Tactic.DeriveComp.html#2831" class="Function">getSTSConstrs</a> <a id="7768" href="Tactic.DeriveComp.html#7531" class="Bound">n</a>
      <a id="7776" href="Tactic.DeriveComp.html#7776" class="Bound">compRes</a> <a id="7784" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7786" href="Tactic.Helpers.html#5060" class="Function">withSafeReset</a> <a id="7800" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="7802" class="Keyword">do</a>
        <a id="7813" href="Tactic.DeriveComp.html#7813" class="Bound">compHole</a> <a id="7822" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7824" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="7832" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
        <a id="7848" href="Tactic.DeriveComp.html#7848" class="Bound">equivHole</a> <a id="7858" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7860" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="7868" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
        <a id="7884" href="Tactic.DeriveComp.html#7884" class="Bound">definition</a> <a id="7895" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7897" href="Interface.MonadTC.html#3435" class="Function">mkRecord</a> <a id="7906" class="Symbol">(</a><a id="7907" class="Keyword">quote</a> <a id="7913" href="Interface.ComputationalRelation.html#627" class="Record">Computational</a><a id="7926" class="Symbol">)</a> <a id="7928" class="Symbol">(</a><a id="7929" href="Tactic.DeriveComp.html#7813" class="Bound">compHole</a> <a id="7938" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7942" href="Tactic.DeriveComp.html#7848" class="Bound">equivHole</a> <a id="7952" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7956" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="7958" class="Symbol">)</a>
        <a id="7968" class="Symbol">_</a> <a id="7970" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="7972" href="Interface.MonadTC.html#1658" class="Field">checkType</a> <a id="7982" href="Tactic.DeriveComp.html#7884" class="Bound">definition</a> <a id="7993" href="Tactic.DeriveComp.html#7634" class="Bound">goalTy</a>
        <a id="8008" href="Interface.MonadTC.html#5942" class="Function">debugLog1ᵐ</a> <a id="8019" class="Symbol">(</a><a id="8020" href="Tactic.DeriveComp.html#7813" class="Bound">compHole</a> <a id="8029" href="Interface.MonadTC.html#5482" class="Function Operator">ᵗ</a><a id="8030" class="Symbol">)</a>
        <a id="8040" href="Interface.MonadTC.html#10492" class="Function">runWithHole</a> <a id="8052" href="Tactic.DeriveComp.html#7813" class="Bound">compHole</a> <a id="8061" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="8063" href="Tactic.DeriveComp.html#7253" class="Function">deriveComp</a> <a id="8074" href="Tactic.DeriveComp.html#7531" class="Bound">n</a> <a id="8076" href="Tactic.DeriveComp.html#7741" class="Bound">stsConstrs</a>
        <a id="8095" href="Interface.MonadTC.html#1739" class="Field">reduce</a> <a id="8102" href="Tactic.DeriveComp.html#7813" class="Bound">compHole</a>
      <a id="8117" href="Interface.MonadTC.html#5576" class="Function">debugLog</a> <a id="8126" class="Symbol">(</a><a id="8127" class="String">&quot;compRes: &quot;</a> <a id="8139" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="8142" href="Tactic.DeriveComp.html#7776" class="Bound">compRes</a> <a id="8150" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="8153" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="8155" class="Symbol">)</a>
      <a id="8163" href="Tactic.DeriveComp.html#8163" class="Bound">cTy</a>   <a id="8169" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="8171" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="8179" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
      <a id="8193" href="Tactic.DeriveComp.html#8193" class="Bound">sTy</a>   <a id="8199" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="8201" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="8209" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
      <a id="8223" href="Tactic.DeriveComp.html#8223" class="Bound">sigTy</a> <a id="8229" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="8231" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="8239" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
      <a id="8253" class="Keyword">let</a> <a id="8257" href="Tactic.DeriveComp.html#8257" class="Bound">isoCxt</a> <a id="8264" class="Symbol">=</a> <a id="8266" class="Symbol">(</a><a id="8267" class="String">&quot;c&quot;</a> <a id="8271" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8273" href="Reflection.AST.Argument.html#1357" class="InductiveConstructor">hArg</a> <a id="8278" href="Tactic.DeriveComp.html#8163" class="Bound">cTy</a><a id="8281" class="Symbol">)</a>
                 <a id="8300" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="8302" class="Symbol">(</a><a id="8303" class="String">&quot;s&quot;</a> <a id="8307" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8309" href="Reflection.AST.Argument.html#1357" class="InductiveConstructor">hArg</a> <a id="8314" class="Symbol">(</a><a id="8315" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="8322" class="Number">1</a> <a id="8324" href="Tactic.DeriveComp.html#8193" class="Bound">sTy</a><a id="8327" class="Symbol">))</a>
                 <a id="8347" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="8349" class="Symbol">(</a><a id="8350" class="String">&quot;sig&quot;</a> <a id="8356" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8358" href="Reflection.AST.Argument.html#1357" class="InductiveConstructor">hArg</a> <a id="8363" class="Symbol">(</a><a id="8364" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="8371" class="Number">2</a> <a id="8373" href="Tactic.DeriveComp.html#8223" class="Bound">sigTy</a><a id="8378" class="Symbol">))</a>
                 <a id="8398" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="8400" class="Symbol">(</a><a id="8401" class="String">&quot;s&#39;&quot;</a> <a id="8406" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8408" href="Reflection.AST.Argument.html#1357" class="InductiveConstructor">hArg</a> <a id="8413" class="Symbol">(</a><a id="8414" href="Reflection.AST.DeBruijn.html#1470" class="Function">weaken</a> <a id="8421" class="Number">3</a> <a id="8423" href="Tactic.DeriveComp.html#8193" class="Bound">sTy</a><a id="8426" class="Symbol">))</a>
                 <a id="8446" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="8448" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
      <a id="8457" href="Tactic.DeriveComp.html#8457" class="Bound">iso</a> <a id="8461" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="8463" href="Tactic.DeriveComp.html#5175" class="Function">extendRawContext</a> <a id="8480" href="Tactic.DeriveComp.html#8257" class="Bound">isoCxt</a> <a id="8487" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="8489" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="8497" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
      <a id="8511" class="Keyword">let</a> <a id="8515" href="Tactic.DeriveComp.html#8515" class="Bound">isolam</a> <a id="8522" class="Symbol">=</a> <a id="8524" href="Generics.Core.html#1310" class="InductiveConstructor Operator">`λ⟅</a> <a id="8528" class="String">&quot;c&quot;</a> <a id="8532" href="Generics.Core.html#1310" class="InductiveConstructor Operator">⟆⇒</a> <a id="8535" href="Generics.Core.html#1310" class="InductiveConstructor Operator">`λ⟅</a> <a id="8539" class="String">&quot;s&quot;</a> <a id="8543" href="Generics.Core.html#1310" class="InductiveConstructor Operator">⟆⇒</a> <a id="8546" href="Generics.Core.html#1310" class="InductiveConstructor Operator">`λ⟅</a> <a id="8550" class="String">&quot;sig&quot;</a> <a id="8556" href="Generics.Core.html#1310" class="InductiveConstructor Operator">⟆⇒</a> <a id="8559" href="Generics.Core.html#1310" class="InductiveConstructor Operator">`λ⟅</a> <a id="8563" class="String">&quot;s&#39;&quot;</a> <a id="8568" href="Generics.Core.html#1310" class="InductiveConstructor Operator">⟆⇒</a> <a id="8571" href="Tactic.DeriveComp.html#8457" class="Bound">iso</a>
      <a id="8581" href="Tactic.DeriveComp.html#8581" class="Bound">definition</a> <a id="8592" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="8594" href="Interface.MonadTC.html#3435" class="Function">mkRecord</a> <a id="8603" class="Symbol">(</a><a id="8604" class="Keyword">quote</a> <a id="8610" href="Interface.ComputationalRelation.html#627" class="Record">Computational</a><a id="8623" class="Symbol">)</a> <a id="8625" class="Symbol">(</a><a id="8626" href="Tactic.DeriveComp.html#7776" class="Bound">compRes</a> <a id="8634" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8638" href="Tactic.DeriveComp.html#8515" class="Bound">isolam</a> <a id="8645" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="8649" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="8651" class="Symbol">)</a>
      <a id="8659" href="Interface.MonadTC.html#2022" class="Field">defineFun</a> <a id="8669" href="Tactic.DeriveComp.html#7533" class="Bound">compName</a> <a id="8678" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="8680" href="Tactic.ClauseBuilder.html#7417" class="Function">nonBindingClause</a> <a id="8697" href="Tactic.DeriveComp.html#8581" class="Bound">definition</a> <a id="8708" href="Data.List.Base.html#5219" class="Function Operator">]</a>
      <a id="8716" href="Tactic.DeriveComp.html#5175" class="Function">extendRawContext</a> <a id="8733" href="Tactic.DeriveComp.html#8257" class="Bound">isoCxt</a> <a id="8740" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="8742" class="Symbol">λ</a> <a id="8744" href="Tactic.DeriveComp.html#8744" class="Bound">_</a> <a id="8746" class="Symbol">→</a> <a id="8748" href="Tactic.DeriveComp.html#6956" class="Function">derive⇔</a> <a id="8756" href="Tactic.DeriveComp.html#7531" class="Bound">n</a> <a id="8758" href="Tactic.DeriveComp.html#7741" class="Bound">stsConstrs</a> <a id="8769" href="Tactic.DeriveComp.html#8457" class="Bound">iso</a>

<a id="8774" class="Comment">-- private module _ {A B : Set} ⦃ _ : DecEq A ⦄ ⦃ _ : DecEq B ⦄ where</a>
<a id="8844" class="Comment">--   open import MyDebugOptions</a>

<a id="8877" class="Comment">--   variable</a>
<a id="8891" class="Comment">--     c : A × B</a>
<a id="8908" class="Comment">--     s s&#39; : A</a>
<a id="8924" class="Comment">--     sig : B</a>

<a id="8940" class="Comment">--   data Test : A × B → A → B → A → Set where</a>
<a id="8987" class="Comment">--     test : proj₁ c ≡ s</a>
<a id="9013" class="Comment">--          → proj₂ c ≡ sig</a>
<a id="9041" class="Comment">--          ------------------------</a>
<a id="9078" class="Comment">--          → Test c s sig (proj₁ c)</a>

<a id="9116" class="Comment">--   unquoteDecl Computational-Test = deriveComputational (quote Test) Computational-Test</a>

<a id="9207" class="Comment">--   -- Sanity checks</a>
<a id="9229" class="Comment">--   testFun : A × B → A → B → Maybe A</a>
<a id="9268" class="Comment">--   testFun c s sig =</a>
<a id="9291" class="Comment">--     if ⌊ ¿ proj₁ c ≡ s × proj₂ c ≡ sig ¿ ⌋ then just (proj₁ c) else nothing</a>

<a id="9371" class="Comment">--   testFunPf⇒ : testFun c s sig ≡ just s&#39; → Test c s sig s&#39;</a>
<a id="9433" class="Comment">--   testFunPf⇒ {c} {s} {sig} h = case ¿ proj₁ c ≡ s × proj₂ c ≡ sig ¿ of λ where</a>
<a id="9515" class="Comment">--     (no ¬p) → case by-reduceDec h of λ ()</a>
<a id="9560" class="Comment">--     (yes p) → subst (Test c s sig) (just-injective $ by-reduceDec h)</a>
<a id="9632" class="Comment">--             $ test (proj₁ p) (proj₂ p)</a>

<a id="9675" class="Comment">--   testFunPf⇐ : Test c s sig s&#39; → testFun c s sig ≡ just s&#39;</a>
<a id="9737" class="Comment">--   testFunPf⇐ {s = s} (test x x₁) = by-reduceDecInGoal (refl {x = just s})</a>

<a id="9815" class="Comment">--   Computational-Test-Manual : Computational Test</a>
<a id="9867" class="Comment">--   Computational-Test-Manual = record</a>
<a id="9907" class="Comment">--     { compute = testFun ; ≡-just⇔STS = mk⇔ testFunPf⇒ testFunPf⇐ }</a>

<a id="9978" class="Comment">--   _ : ∀ {c s sig} → testFun c s sig ≡ Computational.compute Computational-Test c s sig</a>
<a id="10068" class="Comment">--   _ = refl</a>
</pre></body></html>